<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="description" content="" />
		<link rel="icon" href="/favicon.png" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		

		

		<link rel="stylesheet" href="/_app/assets/start-61d1577b.css">
		<link rel="modulepreload" href="/_app/start-a80c730b.js">
		<link rel="modulepreload" href="/_app/chunks/vendor-9b9d6288.js">
		<link rel="modulepreload" href="/_app/pages/__layout.svelte-de46afb2.js">
		<link rel="modulepreload" href="/_app/pages/_lang_/__layout.svelte-e75718c6.js">
		<link rel="modulepreload" href="/_app/chunks/stores-191d1505.js">
		<link rel="modulepreload" href="/_app/pages/_lang_/_lessons_/_slug_/index.svelte-efe77d76.js">

		<script type="module">
			import { start } from "/_app/start-a80c730b.js";
			start({
				target: document.querySelector("#svelte"),
				paths: {"base":"","assets":""},
				session: {},
				route: true,
				spa: false,
				trailing_slash: "never",
				hydrate: {
					status: 200,
					error: null,
					nodes: [
						import("/_app/pages/__layout.svelte-de46afb2.js"),
						import("/_app/pages/_lang_/__layout.svelte-e75718c6.js"),
						import("/_app/pages/_lang_/_lessons_/_slug_/index.svelte-efe77d76.js")
					],
					url: new URL("sveltekit://prerender/es/lecciones/administracion-de-datos-en-r"),
					params: {lang:"es",lessons:"lecciones",slug:"administracion-de-datos-en-r"}
				}
			});
		</script><script>
			if ('serviceWorker' in navigator) {
				navigator.serviceWorker.register('/service-worker.js');
			}
		</script>
	</head>
	<body>
		<div id="svelte">


The Programming Historian <a href="/en">English</a> <a href="/es">Spanish</a>
<br>
This is the es edition.

<h1>Administración de datos en R</h1>

<!-- HTML_TAG_START --><p>{% include toc.html %}</p>
<h2 id="requisitos">Requisitos</h2>
<p>En esta lección asumimos que tienes cierto conocimiento sobre R. Si no has completado el tutorial de <a href="/es/lecciones/datos-tabulares-en-r">datos tabulares básicos con R</a>, te recomendamos hacerlo. Saber otro lenguaje de programación también te será útil. Si necesitas un lugar donde empezar, recomendamos trabajar con los excelentes tutoriales sobre <a href="/es/lecciones/?topic=python">Python</a> en <em>The Programming Historian en español</em>.</p>
<h2 id="objetivos-de-la-lección">Objetivos de la lección</h2>
<p>Al final de la lección,</p>
<ol>
<li>sabrás cómo trabajar con datos ordenados y su importancia.</li>
<li>entenderás el paquete <code>dplyr</code> y podrás usarlo para manipular y administrar datos.</li>
<li>conocerás la línea de operaciones de R y observarás su utilidad para crear código más legible.</li>
<li>aprenderás las bases del análisis exploratorio de datos a través de algunos ejemplos básicos de manipulación de datos.</li>
</ol>
<h2 id="introducción">Introducción</h2>
<p>Los datos que puedes encontrar disponibles en red raramente están en el formato necesario para su análisis y necesitarás manipularlos antes de explorar las preguntas que te interesan. ¡Esto puede llevar más tiempo que el análisis! En este tutorial vamos a aprender algunas técnicas básicas de manipulación, manejo y administración de tus datos en R. Más específicamente, vamos a seguir la filosofía de &quot;datos limpios&quot; o <a href="https://www.jstatsoft.org/article/view/v059i10"><em>&quot;tidy data&quot;</em></a> articulada por Hadley Wickham.</p>
<p>Según <a href="http://hadley.nz">Wickham</a>, los datos están &quot;limpios&quot; cuando cumplen tres criterios:</p>
<ol>
<li>Cada observación está en una fila.</li>
<li>Cada variable está en una columna.</li>
<li>Cada valor tiene su propia celda.</li>
</ol>
<p>Prestar atención a estos criterios nos permite identificar datos organizados o desorganizados. También nos ofrece un esquema estándar y un conjunto de herramientas para limpiar alguna de las formas más comunes en que un conjunto de datos puede estar &quot;desordenado&quot;, como por ejemplo si:</p>
<ul>
<li>los títulos de las columnas son valores en vez de nombres de variables.</li>
<li>hay múltiples variables en una columna.</li>
<li>las variables están en las filas y en las columnas.</li>
<li>hay unidades observacionales de diferente tipo guardadas en la misma tabla.</li>
<li>una única unidad observacional está guardada en varias tablas.</li>
</ul>
<p>Tal vez lo más importante sea que tener nuestros datos en este formato nos permite usar una colección de paquetes del <a href="https://www.tidyverse.org">&quot;tidyverse&quot;</a> que están diseñados para trabajar específicamente con datos limpios. Asegurándonos de que nuestros datos de entrada y de salida están ordenados, podemos usar un pequeño conjunto de herramientas para resolver un amplio número de preguntas. Además, podemos combinar, manipular y dividir conjuntos de datos ordenados como creamos más conveniente.</p>
<p>En este tutorial nos enfocamos en el paquete <a href="https://cran.r-project.org/web/packages/dplyr/index.html">dplyr</a> de tidyverse pero merece la pena mencionar otros que nos encontraremos por el camino:</p>
<p><a href="https://magrittr.tidyverse.org"><strong>magittr</strong></a>: Este paquete nos da acceso al el operador <code>%&gt;%</code> y hace nuestro código más fácilmente de leer.
<a href="https://ggplot2.tidyverse.org"><strong>ggplot2</strong></a>: Este paquete utiliza  <a href="http://academica-e.unavarra.es/bitstream/handle/2454/15785/Gram%C3%A1tica.pdf?sequence=1">&quot;la gramática de gráficos&quot;</a>[^1] para ofrecer una manera fácil de visualizar nuestros datos.
<a href="https://readr.tidyverse.org"><strong>readr</strong></a>: Este paquete da acceso a un método más rápido y racionalizado para importar datos rectangulares (una tabla), como son los archivos CSV (valores separados por comas).
<a href="https://tibble.tidyverse.org"><strong>tibble</strong></a>: Este paquete nos permite reconceptualizar el formato <em>data frame</em> (marco o tabla de datos) para que sea más fácil trabajar con ellos e imprimirlos.</p>
<p>Si todavía no lo has hecho, deberías instalar y cargar &quot;tidyverse&quot; antes de empezar. Además, asegúrate de tener la <a href="https://cran.rstudio.com">versión más reciente de R</a> y de la <a href="https://www.rstudio.com/products/rstudio/download/">plataforma R Studio</a> correspondientes a tu sistema operativo.</p>
<p>Copia el siguiente código en R Studio. Para ejecutarlo tienes que marcar las líneas y clicar Ctrl+Intro (Cmd+Intro en Mac OS):</p>
<pre><code># Instala y carga la biblioteca tidyverse
# No te preocupes si esto toma un tiempo

&gt; install.packages(&quot;tidyverse&quot;)
&gt; library(tidyverse)
</code></pre>
<h2 id="un-ejemplo-de-dplyr-en-acción">Un ejemplo de dplyr en acción</h2>
<p>Veamos un ejemplo de cómo dyplr nos puede ayudar a los historiadores. Vamos a cargar los datos del censo decenal de 1790 a 2010 de Estados Unidos. Descarga los datos haciendo <a href="/assets/ejemplo_introductorio_estados.csv">click aquí</a>[^2] y ponlos en la carpeta que vas a utilizar para trabajar en los ejemplos de este tutorial.</p>
<p>Como los datos están en un archivo CSV, vamos a usar el comando de lectura <code>read_csv()</code> en el paquete <a href="https://cran.r-project.org/web/packages/readr/vignettes/readr.html">readr</a> de &quot;tidyverse&quot;.</p>
<p>La función <code>read_csv</code> (leer archivo de valores separados por comas) toma la ruta del archivo que queremos importar como una variable, así que asegúrate de escribirlo correctamente.</p>
<pre><code># Importar el archivo CSV y guardarlo como importacion_poblacion_estados_eeuu
# Asegúrate de tener la ruta correcta al archivo

importacion_poblacion_estados_eeuu &lt;-read_csv(&quot;ejemplo_introductorio_estados.csv&quot;)
</code></pre>
<p>Una vez que importas los datos, verás que hay tres columnas: una para la población, otra para el año y otra para el estado. Estos datos ya están en un formato limpio y nos dan multitud de opciones para explorarlos.</p>
<p>Para el particular, vamos a visualizar el crecimiento de la población de California y Nueva York para conocer mejor de la migración del oeste.[^3] Vamos a usar <code>dplyr</code> para filtrar los datos que contienen solo la información de los estados que nos interesan y ggplot2 para visualizar dichos datos. Este ejercicio es solo un ejemplo para que te hagas una idea de lo que puede hacer <code>dplyr</code>, así que no te preocupes si no entiendes el código en este momento.</p>
<pre><code># Filtrar solo los estados de California y Nueva York
poblacion_california_nueva_york &lt;- importacion_poblacion_estados_eeuu %&gt;%
  filter(estado %in% c(&quot;California&quot;, &quot;Nueva York&quot;))

# Visualizar las poblaciones de California y Nueva York
ggplot(data=poblacion_california_nueva_york, aes(x=año, y=poblacion, color=estado)) +
  geom_line() +
  geom_point()
</code></pre>
<p>{% include figure.html filename=&quot;california_nueva_york_poblacion.png&quot; caption=&quot;Gráfico de la población de los estados de California y de Nueva York&quot; %}</p>
<p>Como podemos ver, la población de California ha crecido de forma considerable en comparación con la de Nueva York. Aunque este ejemplo pueda parecer obvio si conoces la historia de migración en los Estados Unidos, el código nos ofrece la base sobre la que podemos elaborar multitud de preguntas similares. Por ejemplo, con un cambio rápido en el código podemos crear un gráfico similar con dos estados diferentes como Mississippi y Virginia.</p>
<pre><code># Filtrar solo los estados de Mississippi y Virginia
poblacion_mississipi_y_virginia &lt;- importacion_poblacion_estados_eeuu %&gt;%
  filter(estado %in% c(&quot;Mississippi&quot;, &quot;Virginia&quot;))

# Visualizar las poblaciones de Mississippi y Virginia
ggplot(data=poblacion_mississipi_y_virginia, aes(x=año, y=poblacion, color=estado)) +
  geom_line() +
  geom_point()
</code></pre>
<p>{% include figure.html filename=&quot;mississipi_virginia_poblacion.png&quot; caption=&quot;Gráfico de la población de los estados de Mississippi y de Virginia&quot; %}</p>
<p>Hacer cambios rápidos en el código y reanalizar nuestros datos es una parte fundamental del análisis exploratorio de datos (AED, o EDA por sus siglas en inglés). En vez de tratar de &quot;probar&quot; una hipótesis, el análisis exploratorio de datos nos ayuda a entender nuestros datos mejor y a hacernos preguntas sobre ellos. Para los historiadores el AED ofrece una forma de saber cuándo indagar más en un tema y cuando dejarlo a un lado, y esto es en el área en el que R sobresale.</p>
<h2 id="línea-de-operaciones">Línea de operaciones</h2>
<p>Antes de ver <code>dplyr</code>, tenemos que entender lo que es la línea de operaciones <code>%&gt;%</code> en R porque la vamos a utilizar mucho en nuestros ejemplos. Como decíamos, la línea de operaciones es parte del paquete  <a href="https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html">magittr</a> creado por <a href="http://stefanbache.dk">Stefan Milton Bache</a> y <a href="http://hadley.nz/">Hadley Wickham</a> y está incluida en tidyverse. Su nombre es un homenaje al pintor surrealista Rene Magritte y su famosa obra &quot;<a href="https://historia-arte.com/obras/la-traicion-de-las-imagenes">La traición de las imágenes</a>&quot;, que muestra una pipa con las palabras &quot;esto no es una pipa&quot; debajo, en francés.</p>
<p>La línea de operaciones te permite pasar lo que está a su izquierda como la primera variable en una función especificada a la derecha. Aunque pueda parecer extraño al principio, una vez que lo aprendas verás que hace tu código más fácil de leer al evitar declaraciones anidadas. No te preocupes si esto te resulta un poco complicado ahora. Será más fácil una vez que trabajemos con ejemplos.</p>
<p>Digamos que nos interesa saber la raíz cuadrada del valor de cada población y luego queremos sumar todas las raíces cuadradas antes de calcular la media. Obviamente, esto no es una medida útil pero demuestra cuán rápido puede complicarse la lectura del código de R. Normalmente, anidaríamos las siguientes declaraciones:</p>
<pre><code>mean(sum(sqrt(importacion_poblacion_estados_eeuu$poblacion)))

## [1] 1256925
</code></pre>
<p>Como ves, con tantos comandos anidados es difícil recordar cuántos paréntesis necesitas y hace que el código sea complicado de leer. Para mitigar esto algunas personas crean vectores temporales entre la llamada a cada función.</p>
<pre><code># Calcular la raíz cuadrada de la población de cada estado
vector_raiz_cuadrada_poblacion_estados &lt;- sqrt(importacion_poblacion_estados_eeuu$poblacion)

# Calcular la suma de las raíces cuadradas de la variable temporal
suma_del_vector_raices_cuadradas_poblacion_estados &lt;- sum(vector_raiz_cuadrada_poblacion_estados)

# Calcular la media de la variable temporal
media_suma_del_vector_raices_cuadradas_poblacion_estados &lt;- mean(suma_del_vector_raices_cuadradas_poblacion_estados)

# Mostrar la mediana
media_suma_del_vector_raices_cuadradas_poblacion_estados

## [1] 1256925
</code></pre>
<p>Aunque vas a obtener la misma respuesta, esto es mucho más legible. Sin embargo, puede llenar tu espacio de trabajo con basura si olvidas borrar los vectores temporales. La línea de operaciones hace todo esto por ti. Aquí está el mismo código con la línea de operador <em>pipe</em>:</p>
<pre><code>importacion_poblacion_estados_eeuu$poblacion%&gt;%sqrt%&gt;%sum%&gt;%mean

## [1] 1256925
</code></pre>
<p>Esto es mucho más fácil de leer e incluso lo podrías hacer más claro escribiéndolo en diferentes líneas</p>
<pre><code># Asegúrate de poner el operador al final de la línea
importacion_poblacion_estados_eeuu$poblacion%&gt;%
  sqrt%&gt;%
  sum%&gt;%
  mean

## [1] 1256925
</code></pre>
<p>Por favor, nota que los vectores o marcos de datos que la línea de operación crea son descartados cuando se completa la operación. Si quieres guardarlos, tienes que pasarlos a una nueva variable:</p>
<pre><code>vector_raiz_y_suma_permanente_poblacion_estados &lt;- importacion_poblacion_estados_eeuu$poblacion%&gt;%sqrt%&gt;%sum%&gt;%mean
vector_raiz_y_suma_permanente_poblacion_estados

## [1] 1256925
</code></pre>
<h2 id="necesitamos-un-nuevo-conjunto-de-datos">Necesitamos un nuevo conjunto de datos</h2>
<p>Ahora que entendemos la línea de operaciones, estamos preparados para empezar a mirar y administrar otro conjunto de datos. Desafortunadamente, para los historiadores, solo hay unos pocos conjuntos disponibles - ¡a lo mejor tú nos puedas ayudar a cambiar esto haciendo los tuyos públicos! Aquí contamos con el paquete <a href="https://cran.r-project.org/web/packages/historydata/index.html">history data</a> (datos históricos) creado por <a href="https://lincolnmullen.com">Lincoln Mullen</a>.</p>
<p>Vamos a instalar y cargar el paquete:</p>
<pre><code># Instalar el paquete historydata
install.packages(&quot;historydata&quot;)

# Cargar el paquete historydata
library(historydata)
</code></pre>
<p>Este paquete contiene ejemplos de conjuntos de datos históricos - el ejemplo anterior con datos del censo del EEUU fue tomado de este paquete (y modificado por la traductora). A lo largo de este tutorial, vamos a trabajar con el conjunto de <code>early_colleges</code> (primeras_universidades) que contiene datos sobre las universidades fundadas antes de 1848.[^4] Lo primero que vamos a hacer es cargar los datos y leerlos:</p>
<pre><code># Asegúrate de que has instalado y cargado el paquete historydata antes de nada

data(early_colleges)
early_colleges

# A tibble: 65 x 6
   college                original_name         city          state established sponsorship
   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
 1 Harvard                NA                    Cambridge     MA           1636 Congregational; after 1805 …
 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican
 3 Yale                   NA                    New Haven     CT           1701 Congregational
 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational
 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian
 6 Columbia               King&#39;s College        New York      NY           1754 Anglican
 7 Brown                  NA                    Providence    RI           1765 Baptist
 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed
 9 Dartmouth              NA                    Hanover       NH           1769 Congregational
10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican
# ... with 55 more rows
</code></pre>
<p>Como puedes ver, este conjunto de datos contiene el nombre actual de la universidad (<em>original_name</em>), la ciudad (<em>city</em>) y el estado (<em>state</em>) en que fue fundada, la fecha en que se fundó (<em>established</em>), y la entidad responsable de su patrocinio (<em>sponsorship</em>). Como ya hemos dicho, antes de poder trabajar con un conjunto de datos, es importante pensar en cómo organizar los datos. Veamos si alguno de estos datos no está en formato &quot;limpio&quot; (<em>&quot;tidy&quot;</em>). ¿Puedes ver alguna celda que no concuerde con los tres criterio de datos limpios?</p>
<p>Si piensas que se trata deel patrocinio de Harvard, estás en lo cierto. Además de señalar el patrocinio original, también menciona que cambió de patrocinador en 1805. Normalmente uno quiere mantener toda la información posible sobre los datos, pero para propósitos de este tutorial, vamos a cambiar la columna para tener solo el patrocinador inicial.</p>
<pre><code>early_colleges[1,6] &lt;- &quot;Congregational&quot;
early_colleges

# A tibble: 65 x 6
   college                original_name         city          state established sponsorship
   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
 1 Harvard                NA                    Cambridge     MA           1636 Congregational
 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican
 3 Yale                   NA                    New Haven     CT           1701 Congregational
 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational
 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian
 6 Columbia               King&#39;s College        New York      NY           1754 Anglican
 7 Brown                  NA                    Providence    RI           1765 Baptist
 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed
 9 Dartmouth              NA                    Hanover       NH           1769 Congregational
10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican
# ... with 55 more rows
</code></pre>
<p>Ahora que tenemos nuestros datos en formato limpio, podemos formatearlos a través del paquete <code>dplyr</code>.</p>
<h2 id="¿qué-es-dplyr">¿Qué es Dplyr?</h2>
<p><a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/dplyr.html">Dplyr</a> es otra parte de tidyverse que proporciona funciones para manipular y transformar tu datos. Dado que nuestros datos van a seguir estando ordenados (<em>tidy</em>), solamente necesitamos un conjunto pequeño de herramientas para explorarlo. Comparándolo con el R Base, el uso de <code>dplyr</code> es más rápido y garantiza que si los datos introducidos (<em>input</em>) están ordenados los datos que obtendremos (<em>output</em>) también lo estarán. Quizás de manera más importante, <code>dplyr</code> hace nuestro código fácil de leer y utiliza &quot;verbos&quot; que son, en su mayoría, intuitivos (para el hablante de inglés). Cada función en <code>dplyr</code> corresponde a estos verbos, siendo los cinco principales filtrar (<code>filter</code>), seleccionar (<code>select</code>), ordenar (<code>arrange</code>), mutar (<code>mutate</code>) y resumir (<code>summarise</code> - con ortografía de inglés británico- o <code>summarize</code> - con ortografía de inglés de EEUU-). Vamos a ver cada una de ellas para entender su funcionamiento en la práctica.</p>
<h3 id="select-seleccionar"><code>select</code> (seleccionar)</h3>
<p>Si miramos el conjunto <code>early_colleges</code> (primeras_universidades), podemos ver que hay muchos &quot;NA&quot; en la columna de nombres originales. NA significa que los datos no están disponibles (del inglés <em>not available</em>), y quizás queramos ver nuestros datos sin esta columna. La función <code>select()</code> de <code>dplyr</code> nos posibilita esto precisamente. Toma el marco de datos que quieres manipular como el primer argumento, seguido de la lista indicando qué columnas queremos mantener:</p>
<pre><code># Deshazte de la columna de nombres originales (&quot;original_name&quot;) usando select()
# Nota que no tienes que añadir el símbolo $ (dólar) al nombre de la columna al final de early_colleges porque `dplyr` asume que &quot;,&quot; (una coma) representa Y (AND en inglés) automáticamente

select(early_colleges, college, city, state, established, sponsorship)

# A tibble: 65 x 5
   college                city          state established sponsorship
   &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
 1 Harvard                Cambridge     MA           1636 Congregational
 2 William and Mary       Williamsburg  VA           1693 Anglican
 3 Yale                   New Haven     CT           1701 Congregational
 4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational
 5 Princeton              Princeton     NJ           1746 Presbyterian
 6 Columbia               New York      NY           1754 Anglican
 7 Brown                  Providence    RI           1765 Baptist
 8 Rutgers                New Brunswick NJ           1766 Dutch Reformed
 9 Dartmouth              Hanover       NH           1769 Congregational
10 Charleston, Coll. Of   Charleston    SC           1770 Anglican
# ... with 55 more rows
</code></pre>
<p>Escribamos también esto mismo usando la línea de operador <code>%&gt;%</code>:</p>
<pre><code>early_colleges%&gt;%
    select(college, city, state, established, sponsorship)

# A tibble: 65 x 5
   college                city          state established sponsorship
   &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
 1 Harvard                Cambridge     MA           1636 Congregational
 2 William and Mary       Williamsburg  VA           1693 Anglican
 3 Yale                   New Haven     CT           1701 Congregational
 4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational
 5 Princeton              Princeton     NJ           1746 Presbyterian
 6 Columbia               New York      NY           1754 Anglican
 7 Brown                  Providence    RI           1765 Baptist
 8 Rutgers                New Brunswick NJ           1766 Dutch Reformed
 9 Dartmouth              Hanover       NH           1769 Congregational
10 Charleston, Coll. Of   Charleston    SC           1770 Anglican
# ... with 55 more rows
</code></pre>
<p>Hacer referencia a cada una de las columnas que queremos mantener para deshacernos de una es un tanto tedioso. Podemos usar el símbolo de restar (-) para indicar que queremos descartar una columna, con su nombre.</p>
<pre><code>early_colleges%&gt;%
    select(-original_name)

    # A tibble: 65 x 5
       college                city          state established sponsorship
       &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
     1 Harvard                Cambridge     MA           1636 Congregational
     2 William and Mary       Williamsburg  VA           1693 Anglican
     3 Yale                   New Haven     CT           1701 Congregational
     4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational
     5 Princeton              Princeton     NJ           1746 Presbyterian
     6 Columbia               New York      NY           1754 Anglican
     7 Brown                  Providence    RI           1765 Baptist
     8 Rutgers                New Brunswick NJ           1766 Dutch Reformed
     9 Dartmouth              Hanover       NH           1769 Congregational
    10 Charleston, Coll. Of   Charleston    SC           1770 Anglican
    # ... with 55 more rows
</code></pre>
<h3 id="filter-filtrar"><code>filter</code> (filtrar)</h3>
<p>La función <code>filter()</code> hace lo mismo que la función <code>select</code> pero en vez de escoger el nombre de la columna, la podemos usar para filtrar filas usando un test de requisitos. Por ejemplo, podemos ver todas las universidades que existían antes del cambio de siglo:</p>
<pre><code>early_colleges%&gt;%
    filter(established &lt; 1800)

    # A tibble: 20 x 6
       college                  original_name         city           state established sponsorship
       &lt;chr&gt;                    &lt;chr&gt;                 &lt;chr&gt;          &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
     1 Harvard                  NA                    Cambridge      MA           1636 Congregational
     2 William and Mary         NA                    Williamsburg   VA           1693 Anglican
     3 Yale                     NA                    New Haven      CT           1701 Congregational
     4 Pennsylvania, Univ. of   NA                    Philadelphia   PA           1740 Nondenominational
     5 Princeton                College of New Jersey Princeton      NJ           1746 Presbyterian
     6 Columbia                 King&#39;s College        New York       NY           1754 Anglican
     7 Brown                    NA                    Providence     RI           1765 Baptist
     8 Rutgers                  Queen&#39;s College       New Brunswick  NJ           1766 Dutch Reformed
     9 Dartmouth                NA                    Hanover        NH           1769 Congregational
    10 Charleston, Coll. Of     NA                    Charleston     SC           1770 Anglican
    11 Hampden-Sydney           NA                    Hampden-Sydney VA           1775 Presbyterian
    12 Transylvania             NA                    Lexington      KY           1780 Disciples of Christ
    13 Georgia, Univ. of        NA                    Athens         GA           1785 Secular
    14 Georgetown               NA                    Washington     DC           1789 Roman Catholic
    15 North Carolina, Univ. of NA                    Chapel Hill    NC           1789 Secular
    16 Vermont, Univ. of        NA                    Burlington     VT           1791 Nondenominational
    17 Williams                 NA                    Williamstown   MA           1793 Congregational
    18 Tennessee, Univ. of      Blount College        Knoxville      TN           1794 Secular
    19 Union College            NA                    Schenectady    NY           1795 Presbyterian with Congre…
    20 Marietta                 NA                    Marietta       OH           1797 Congregational
</code></pre>
<h3 id="mutate-mutar"><code>mutate</code> (mutar)</h3>
<p>El comando <code>mutate</code> nos permite añadir una columna al conjunto de datos. Ahora mismo, tenemos la ciudad y el estado en dos columnas diferentes. Podemos usar el comando de pegar (<code>paste</code>) para combinar dos cadenas de caracteres y especificar un separador. Pongámoslas en una única columna llamada &quot;location&quot; (lugar):</p>
<pre><code>early_colleges%&gt;%mutate(location=paste(city,state,sep=&quot;,&quot;))

# A tibble: 65 x 7
   college                original_name         city          state established sponsorship       location
   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;
 1 Harvard                NA                    Cambridge     MA           1636 Congregational    Cambridge,MA
 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican          Williamsburg,VA
 3 Yale                   NA                    New Haven     CT           1701 Congregational    New Haven,CT
 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational Philadelphia,PA
 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian      Princeton,NJ
 6 Columbia               King&#39;s College        New York      NY           1754 Anglican          New York,NY
 7 Brown                  NA                    Providence    RI           1765 Baptist           Providence,RI
 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed    New Brunswick,NJ
 9 Dartmouth              NA                    Hanover       NH           1769 Congregational    Hanover,NH
10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican          Charleston,SC
# ... with 55 more rows
</code></pre>
<p>Recuerda que <code>dplyr</code> no guarda los datos ni manipula el original. Al contrario, crea marcos de datos temporales en cada paso. Si quieres guardarlos, tienes que crear una variable permanente con <code>&lt;-</code>:</p>
<pre><code>primeras_universidades_con_localizacion &lt;- early_colleges%&gt;%
  mutate(location=paste(city, state, sep=&quot;,&quot;))

# Observa la nueva tabla con la localización añadida
primeras_universidades_con_localizacion

# A tibble: 65 x 7
   college                original_name         city          state established sponsorship       location
   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;
 1 Harvard                NA                    Cambridge     MA           1636 Congregational    Cambridge,MA
 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican          Williamsburg,VA
 3 Yale                   NA                    New Haven     CT           1701 Congregational    New Haven,CT
 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational Philadelphia,PA
 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian      Princeton,NJ
 6 Columbia               King&#39;s College        New York      NY           1754 Anglican          New York,NY
 7 Brown                  NA                    Providence    RI           1765 Baptist           Providence,RI
 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed    New Brunswick,NJ
 9 Dartmouth              NA                    Hanover       NH           1769 Congregational    Hanover,NH
10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican          Charleston,SC
# ... with 55 more rows
</code></pre>
<h3 id="arrangeordenar"><code>arrange</code>(ordenar)</h3>
<p>La función <code>arrange</code> nos permite ordenar nuestras columnas de una nueva forma. Ahora mismo, las universidades están organizadas por año en orden ascendiente. Pongámoslas en el orden descendiente de fundación desde, en este caso, el fin de la guerra con México en 1848.[^5]</p>
<pre><code>early_colleges %&gt;%
   arrange(desc(established))

# A tibble: 65 x 6
   college               original_name city        state established sponsorship
   &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;
 1 Wisconsin, Univ. of   NA            Madison     WI           1848 Secular
 2 Earlham               NA            Richmond    IN           1847 Quaker
 3 Beloit                NA            Beloit      WI           1846 Congregational
 4 Bucknell              NA            Lewisburg   PA           1846 Baptist
 5 Grinnell              NA            Grinnell    IA           1846 Congregational
 6 Mount Union           NA            Alliance    OH           1846 Methodist
 7 Louisiana, Univ. of   NA            New Orleans LA           1845 Secular
 8 U.S. Naval Academy    NA            Annapolis   MD           1845 Secular
 9 Mississipps, Univ. of NA            Oxford      MI           1844 Secular
10 Holy Cross            NA            Worchester  MA           1843 Roman Catholic
# ... with 55 more rows
</code></pre>
<h3 id="summarise-resumir"><code>summarise</code> (resumir)</h3>
<p>La última función clave en <code>dplyr</code> es <code>summarise()</code> - en ortografía británica (con &#39;s&#39;) o en estadounidense (con &#39;z&#39;). <code>summarise()</code> toma una función u operación y generalmente se usa para crear un <em>data frame</em> que contiene los datos estadísticos de resumen y que podemos visualizar en forma de gráfico. Aquí la vamos a usar para calcular el año promedio en que se fundaron las universidades antes de 1848.</p>
<pre><code>early_colleges%&gt;%summarise(mean(established))

# A tibble: 1 x 1
  `mean(established)`
                &lt;dbl&gt;
1            1809.831
</code></pre>
<h2 id="poniéndolo-todo-junto">Poniéndolo todo junto</h2>
<p>Ahora que hemos aprendido los cinco verbos principales para <code>dplyr</code>, podemos usarlos para crear rápidas visualizaciones de nuestros datos. Vamos a crear un gráfico de barras mostrando el número de universidades laicas y religiosas antes de la Guerra de EEUU de 1812[^6]:</p>
<pre><code>universidades_seculares_antes_1812 &lt;- early_colleges%&gt;%
  filter(established &lt; 1812)%&gt;%
  mutate(es_laica=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;si&quot;))
</code></pre>
<p>Primero, se ejecuta la función de filtrado para escoger aquellas universidades establecidas antes de 1812. Luego, en la función <code>mutate</code> la función interna <code>ifelse</code> (<em>if...else...</em> o si...si no...) genera un test de verdadero (TRUE) o falso (FALSE) sobre los valores de la columna &quot;sponsorship&quot; y genera otra columna &quot;es_laica&quot; con los resultados; tal que &quot;si el valor en la columna no es igual a (<code>!=</code>) &quot;Secular&quot; añade un &quot;no&quot; en la nueva columna, si dice &quot;Secular&quot; añade un &quot;si&quot;, repitiendo la operación para cada fila, en este caso para cada universidad [N. de la T.].</p>
<p>Ahora podemos visualizar los datos:</p>
<pre><code>ggplot(universidades_seculares_antes_1812) +
  geom_bar(aes(x=es_laica, fill=es_laica))+
  labs(title=&quot;Tipo de universidad antes de 1812&quot;, x=&quot;¿Es laica la universidad?&quot;, y=&quot;Recuento&quot;)
</code></pre>
<p>{% include figure.html filename=&quot;universidades_seculares_antes_1812.png&quot; caption=&quot;Número de universidades laicas y religiosas antes de la Guerra de 1812&quot; %}</p>
<p>De nuevo, haciendo un cambio rápido en nuestro código, podemos también mirar el número de universidades laicas y religiosas después del comienzo de la Guerra de 1812:</p>
<pre><code>universidades_seculares_despues_1812&lt;-early_colleges%&gt;%
  filter(established &gt; 1812)%&gt;%
  mutate(es_laica=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;si&quot;))

ggplot(universidades_seculares_despues_1812) +
  geom_bar(aes(x=es_laica, fill=es_laica))+
  labs(x=&quot;¿Es laica la universidad?&quot;, y=&quot;Recuento&quot;)
</code></pre>
<p>{% include figure.html filename=&quot;universidades_seculares_despues_1812.png&quot; caption=&quot;Número de universidades laicas y religiosas después de la Guerra de 1812&quot; %}</p>
<h2 id="conclusión">Conclusión</h2>
<p>Este tutorial debería darte una idea de cómo organizar y manipular tus datos en R. Más adelante quizás quieras visualizar tus datos de alguna otra forma. Te recomiendo que empieces por explorar el paquete <a href="https://ggplot2.tidyverse.org/">ggplot2</a> (ver abajo) porque su conjunto de herramientas funciona muy bien con <code>dplyr</code>. Además, puede que quieras examinar alguna otra función de las que viene con <code>dplyr</code> para mejorar tus habilidades. En todo caso, esto te proporciona una buena base sobre la que construir para abarcar algunos de los problemas comunes que encontrarás.</p>
<h2 id="recursos-adicionales-en-español">Recursos adicionales en español</h2>
<ul>
<li><p><a href="https://swcarpentry.github.io/r-novice-gapminder-es/">R para Análisis Científicos Reproducibles</a> de Software Carpentry (2018) tiene más información sobre cómo utilizar <code>dplyr</code> para tus datos.</p>
</li>
<li><p>Para aprender más sobre el paquete &#39;ggplot2&#39; puedes consultar la sección &quot;<a href="https://es.r4ds.hadley.nz/visualizaci%C3%B3n-de-datos.html">Visualización de datos</a>&quot; en el libro <em>R para Ciencia de Datos</em> de Hadley Wickham y Garrett Grolemund.</p>
</li>
<li><p>Tanto la <em><a href="https://www.inei.gob.pe/media/MenuRecursivo/metodologias/libro.pdf">Guía  para  la  Presentación  de  Gráficos  Estadísticos</a>,</em> del Instituto  Nacional  de Estadística e Informática (2009) así como la <a href="http://academica-e.unavarra.es/bitstream/handle/2454/15785/Gram%C3%A1tica.pdf?sequence=1"><em>Gramática de las gráficas: Pistas para mejorar las representaciones de datos</em></a> de Joaquín Sevilla Moróder ofrecen explicaciones de cómo presentar tus datos y errores a evitar.</p>
</li>
</ul>
<p>[^1]: En el tutorial original se hace referencia al libro &quot;<a href="https://www.springer.com/us/book/9780387245447">The Grammar of Graphics</a>&quot; (2005) de Wilkinson.</p>
<p>[^2]: Este listado contiene el censo de la población de cada estado desde 1790, es decir, a partir de la formación de los Estados Unidos de América. De esta manera, el listado comienza con 15 estados (los 13 primeros estados eran ya parte del país desde su <a href="https://es.wikipedia.org/wiki/Declaraci%C3%B3n_de_Independencia_de_los_Estados_Unidos">independencia en 1776</a>, pero no se ratificó su admisión hasta la <a href="https://es.wikipedia.org/wiki/Constituci%C3%B3n_de_los_Estados_Unidos">Constitución de 1787</a>), los del noreste y parte del sureste, a los que se van añadiendo territorios (que luego se convertirán en estado) a lo largo de los siglos XIX y XX, hasta llegar a la actual división territorial del país: <a href="https://es.wikipedia.org/wiki/Anexo:Estados_y_Territorios_de_los_Estados_Unidos#Lista_de_estados">50 estados</a>, un <a href="https://es.wikipedia.org/wiki/Anexo:Estados_y_Territorios_de_los_Estados_Unidos#Distrito_Federal">distrito federal</a> y varios <a href="https://es.wikipedia.org/wiki/Anexo:Estados_y_Territorios_de_los_Estados_Unidos#Territorios">territorios no incorporados</a> (Puerto Rico aparece en este censo pero no es un estado como tal, sino un <a href="https://es.wikipedia.org/wiki/Estado_libre_asociado">estado libre asociado</a> o territorio). Se han traducido los datos originales (en inglés) al español. [N. de la T.]</p>
<p>[^3]: <a href="https://es.wikipedia.org/wiki/Historia_territorial_de_los_Estados_Unidos">La migración hacia el oeste de los Estados Unidos</a> se dio durante el siglo XIX a partir de la compra de Luisiana (a Francia) y hasta su llegada a la costa Pacífico, despojando a los norteamericanos nativos de sus tierras mediante la violencia. Nótese, además, que California fue incorporada a los Estados Unidos en 1850, tras su cesión por parte de México al finalizar la guerra entre ambos países (1846-1848) por el <a href="https://es.wikipedia.org/wiki/Tratado_de_Guadalupe_Hidalgo">Tratado de Guadalupe Hidalgo</a>.</p>
<p>[^4]: No traducimos estos conjunto pero, por suerte, los datos son bastante intuitivos al tratarse de nombres propios, ciudades, años e iglesias cuyos nombres son cognados entre inglés y español (Anglican por anglicana, Presbyterian por presbiteriana, etc.) [N.de la T.]</p>
<p>[^5]: La también llamada <a href="https://es.wikipedia.org/wiki/Intervenci%C3%B3n_estadounidense_en_M%C3%A9xico">Guerra Mexico-Americana</a> fue la guerra librada entre los Estados Unidos y México desde 1846 hasta la firma del <a href="https://es.wikipedia.org/wiki/Tratado_de_Guadalupe_Hidalgo">Tratado de Guadalupe Hidalgo</a> en 1848 y la <a href="https://es.wikipedia.org/wiki/Cesi%C3%B3n_mexicana">cesión mexicana</a>.</p>
<p>[^6]: La <a href="https://es.wikipedia.org/wiki/Guerra_anglo-estadounidense_de_1812">Guerra de 1812</a>, o guerra anglo-estadounidense, enfrentó a los EEUU contra el Reino Unido al tratar los primeros de conquistar los territorios coloniales de los segundos. Finalizó en 1815.</p>
<!-- HTML_TAG_END -->

<script type="application/json" data-type="svelte-data" data-url="administracion-de-datos-en-r/raw.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"metadata\":{\"title\":\"Administración de datos en R\",\"authors\":[\"Nabeel Siddiqui\"],\"date\":\"2017-07-31T00:00:00.000Z\",\"translation_date\":\"2018-10-10T00:00:00.000Z\",\"editors\":[\"Ian Milligan\"],\"reviewers\":[\"Lauren Tilton\",\"Ryan Deschamps\"],\"translator\":[\"Jennifer Isasi\"],\"translation-editor\":[\"Victor Gayol\"],\"translation-reviewer\":[\"Riva Quiroga\",\"Victor Gayol\"],\"review-ticket\":\"https:\u002F\u002Fgithub.com\u002Fprogramminghistorian\u002Fph-submissions\u002Fissues\u002F199\",\"layout\":\"lesson\",\"original\":\"data_wrangling_and_management_in_R\",\"difficulty\":2,\"activity\":\"transforming\",\"topics\":[\"data-manipulation\",\"data-management\",\"distant-reading\"],\"abstract\":\"Este tutorial explora la manera en que los académicos pueden administrar datos de forma ordenada, entender paquetes de R para manipular los datos y llevar a cabo un análisis básico de datos.\",\"avatar_alt\":\"Anuncio de pastilla de jabón\",\"doi\":\"10.46430\u002Fphes0031\"},\"html_body\":\"\u003Cp\u003E{% include toc.html %}\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"requisitos\\\"\u003ERequisitos\u003C\u002Fh2\u003E\\n\u003Cp\u003EEn esta lección asumimos que tienes cierto conocimiento sobre R. Si no has completado el tutorial de \u003Ca href=\\\"\u002Fes\u002Flecciones\u002Fdatos-tabulares-en-r\\\"\u003Edatos tabulares básicos con R\u003C\u002Fa\u003E, te recomendamos hacerlo. Saber otro lenguaje de programación también te será útil. Si necesitas un lugar donde empezar, recomendamos trabajar con los excelentes tutoriales sobre \u003Ca href=\\\"\u002Fes\u002Flecciones\u002F?topic=python\\\"\u003EPython\u003C\u002Fa\u003E en \u003Cem\u003EThe Programming Historian en español\u003C\u002Fem\u003E.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"objetivos-de-la-lección\\\"\u003EObjetivos de la lección\u003C\u002Fh2\u003E\\n\u003Cp\u003EAl final de la lección,\u003C\u002Fp\u003E\\n\u003Col\u003E\\n\u003Cli\u003Esabrás cómo trabajar con datos ordenados y su importancia.\u003C\u002Fli\u003E\\n\u003Cli\u003Eentenderás el paquete \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E y podrás usarlo para manipular y administrar datos.\u003C\u002Fli\u003E\\n\u003Cli\u003Econocerás la línea de operaciones de R y observarás su utilidad para crear código más legible.\u003C\u002Fli\u003E\\n\u003Cli\u003Eaprenderás las bases del análisis exploratorio de datos a través de algunos ejemplos básicos de manipulación de datos.\u003C\u002Fli\u003E\\n\u003C\u002Fol\u003E\\n\u003Ch2 id=\\\"introducción\\\"\u003EIntroducción\u003C\u002Fh2\u003E\\n\u003Cp\u003ELos datos que puedes encontrar disponibles en red raramente están en el formato necesario para su análisis y necesitarás manipularlos antes de explorar las preguntas que te interesan. ¡Esto puede llevar más tiempo que el análisis! En este tutorial vamos a aprender algunas técnicas básicas de manipulación, manejo y administración de tus datos en R. Más específicamente, vamos a seguir la filosofía de &quot;datos limpios&quot; o \u003Ca href=\\\"https:\u002F\u002Fwww.jstatsoft.org\u002Farticle\u002Fview\u002Fv059i10\\\"\u003E\u003Cem\u003E&quot;tidy data&quot;\u003C\u002Fem\u003E\u003C\u002Fa\u003E articulada por Hadley Wickham.\u003C\u002Fp\u003E\\n\u003Cp\u003ESegún \u003Ca href=\\\"http:\u002F\u002Fhadley.nz\\\"\u003EWickham\u003C\u002Fa\u003E, los datos están &quot;limpios&quot; cuando cumplen tres criterios:\u003C\u002Fp\u003E\\n\u003Col\u003E\\n\u003Cli\u003ECada observación está en una fila.\u003C\u002Fli\u003E\\n\u003Cli\u003ECada variable está en una columna.\u003C\u002Fli\u003E\\n\u003Cli\u003ECada valor tiene su propia celda.\u003C\u002Fli\u003E\\n\u003C\u002Fol\u003E\\n\u003Cp\u003EPrestar atención a estos criterios nos permite identificar datos organizados o desorganizados. También nos ofrece un esquema estándar y un conjunto de herramientas para limpiar alguna de las formas más comunes en que un conjunto de datos puede estar &quot;desordenado&quot;, como por ejemplo si:\u003C\u002Fp\u003E\\n\u003Cul\u003E\\n\u003Cli\u003Elos títulos de las columnas son valores en vez de nombres de variables.\u003C\u002Fli\u003E\\n\u003Cli\u003Ehay múltiples variables en una columna.\u003C\u002Fli\u003E\\n\u003Cli\u003Elas variables están en las filas y en las columnas.\u003C\u002Fli\u003E\\n\u003Cli\u003Ehay unidades observacionales de diferente tipo guardadas en la misma tabla.\u003C\u002Fli\u003E\\n\u003Cli\u003Euna única unidad observacional está guardada en varias tablas.\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003ETal vez lo más importante sea que tener nuestros datos en este formato nos permite usar una colección de paquetes del \u003Ca href=\\\"https:\u002F\u002Fwww.tidyverse.org\\\"\u003E&quot;tidyverse&quot;\u003C\u002Fa\u003E que están diseñados para trabajar específicamente con datos limpios. Asegurándonos de que nuestros datos de entrada y de salida están ordenados, podemos usar un pequeño conjunto de herramientas para resolver un amplio número de preguntas. Además, podemos combinar, manipular y dividir conjuntos de datos ordenados como creamos más conveniente.\u003C\u002Fp\u003E\\n\u003Cp\u003EEn este tutorial nos enfocamos en el paquete \u003Ca href=\\\"https:\u002F\u002Fcran.r-project.org\u002Fweb\u002Fpackages\u002Fdplyr\u002Findex.html\\\"\u003Edplyr\u003C\u002Fa\u003E de tidyverse pero merece la pena mencionar otros que nos encontraremos por el camino:\u003C\u002Fp\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fmagrittr.tidyverse.org\\\"\u003E\u003Cstrong\u003Emagittr\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E: Este paquete nos da acceso al el operador \u003Ccode\u003E%&gt;%\u003C\u002Fcode\u003E y hace nuestro código más fácilmente de leer.\\n\u003Ca href=\\\"https:\u002F\u002Fggplot2.tidyverse.org\\\"\u003E\u003Cstrong\u003Eggplot2\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E: Este paquete utiliza  \u003Ca href=\\\"http:\u002F\u002Facademica-e.unavarra.es\u002Fbitstream\u002Fhandle\u002F2454\u002F15785\u002FGram%C3%A1tica.pdf?sequence=1\\\"\u003E&quot;la gramática de gráficos&quot;\u003C\u002Fa\u003E[^1] para ofrecer una manera fácil de visualizar nuestros datos.\\n\u003Ca href=\\\"https:\u002F\u002Freadr.tidyverse.org\\\"\u003E\u003Cstrong\u003Ereadr\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E: Este paquete da acceso a un método más rápido y racionalizado para importar datos rectangulares (una tabla), como son los archivos CSV (valores separados por comas).\\n\u003Ca href=\\\"https:\u002F\u002Ftibble.tidyverse.org\\\"\u003E\u003Cstrong\u003Etibble\u003C\u002Fstrong\u003E\u003C\u002Fa\u003E: Este paquete nos permite reconceptualizar el formato \u003Cem\u003Edata frame\u003C\u002Fem\u003E (marco o tabla de datos) para que sea más fácil trabajar con ellos e imprimirlos.\u003C\u002Fp\u003E\\n\u003Cp\u003ESi todavía no lo has hecho, deberías instalar y cargar &quot;tidyverse&quot; antes de empezar. Además, asegúrate de tener la \u003Ca href=\\\"https:\u002F\u002Fcran.rstudio.com\\\"\u003Eversión más reciente de R\u003C\u002Fa\u003E y de la \u003Ca href=\\\"https:\u002F\u002Fwww.rstudio.com\u002Fproducts\u002Frstudio\u002Fdownload\u002F\\\"\u003Eplataforma R Studio\u003C\u002Fa\u003E correspondientes a tu sistema operativo.\u003C\u002Fp\u003E\\n\u003Cp\u003ECopia el siguiente código en R Studio. Para ejecutarlo tienes que marcar las líneas y clicar Ctrl+Intro (Cmd+Intro en Mac OS):\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Instala y carga la biblioteca tidyverse\\n# No te preocupes si esto toma un tiempo\\n\\n&gt; install.packages(&quot;tidyverse&quot;)\\n&gt; library(tidyverse)\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch2 id=\\\"un-ejemplo-de-dplyr-en-acción\\\"\u003EUn ejemplo de dplyr en acción\u003C\u002Fh2\u003E\\n\u003Cp\u003EVeamos un ejemplo de cómo dyplr nos puede ayudar a los historiadores. Vamos a cargar los datos del censo decenal de 1790 a 2010 de Estados Unidos. Descarga los datos haciendo \u003Ca href=\\\"\u002Fassets\u002Fejemplo_introductorio_estados.csv\\\"\u003Eclick aquí\u003C\u002Fa\u003E[^2] y ponlos en la carpeta que vas a utilizar para trabajar en los ejemplos de este tutorial.\u003C\u002Fp\u003E\\n\u003Cp\u003EComo los datos están en un archivo CSV, vamos a usar el comando de lectura \u003Ccode\u003Eread_csv()\u003C\u002Fcode\u003E en el paquete \u003Ca href=\\\"https:\u002F\u002Fcran.r-project.org\u002Fweb\u002Fpackages\u002Freadr\u002Fvignettes\u002Freadr.html\\\"\u003Ereadr\u003C\u002Fa\u003E de &quot;tidyverse&quot;.\u003C\u002Fp\u003E\\n\u003Cp\u003ELa función \u003Ccode\u003Eread_csv\u003C\u002Fcode\u003E (leer archivo de valores separados por comas) toma la ruta del archivo que queremos importar como una variable, así que asegúrate de escribirlo correctamente.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Importar el archivo CSV y guardarlo como importacion_poblacion_estados_eeuu\\n# Asegúrate de tener la ruta correcta al archivo\\n\\nimportacion_poblacion_estados_eeuu &lt;-read_csv(&quot;ejemplo_introductorio_estados.csv&quot;)\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EUna vez que importas los datos, verás que hay tres columnas: una para la población, otra para el año y otra para el estado. Estos datos ya están en un formato limpio y nos dan multitud de opciones para explorarlos.\u003C\u002Fp\u003E\\n\u003Cp\u003EPara el particular, vamos a visualizar el crecimiento de la población de California y Nueva York para conocer mejor de la migración del oeste.[^3] Vamos a usar \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E para filtrar los datos que contienen solo la información de los estados que nos interesan y ggplot2 para visualizar dichos datos. Este ejercicio es solo un ejemplo para que te hagas una idea de lo que puede hacer \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E, así que no te preocupes si no entiendes el código en este momento.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Filtrar solo los estados de California y Nueva York\\npoblacion_california_nueva_york &lt;- importacion_poblacion_estados_eeuu %&gt;%\\n  filter(estado %in% c(&quot;California&quot;, &quot;Nueva York&quot;))\\n\\n# Visualizar las poblaciones de California y Nueva York\\nggplot(data=poblacion_california_nueva_york, aes(x=año, y=poblacion, color=estado)) +\\n  geom_line() +\\n  geom_point()\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E{% include figure.html filename=&quot;california_nueva_york_poblacion.png&quot; caption=&quot;Gráfico de la población de los estados de California y de Nueva York&quot; %}\u003C\u002Fp\u003E\\n\u003Cp\u003EComo podemos ver, la población de California ha crecido de forma considerable en comparación con la de Nueva York. Aunque este ejemplo pueda parecer obvio si conoces la historia de migración en los Estados Unidos, el código nos ofrece la base sobre la que podemos elaborar multitud de preguntas similares. Por ejemplo, con un cambio rápido en el código podemos crear un gráfico similar con dos estados diferentes como Mississippi y Virginia.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Filtrar solo los estados de Mississippi y Virginia\\npoblacion_mississipi_y_virginia &lt;- importacion_poblacion_estados_eeuu %&gt;%\\n  filter(estado %in% c(&quot;Mississippi&quot;, &quot;Virginia&quot;))\\n\\n# Visualizar las poblaciones de Mississippi y Virginia\\nggplot(data=poblacion_mississipi_y_virginia, aes(x=año, y=poblacion, color=estado)) +\\n  geom_line() +\\n  geom_point()\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E{% include figure.html filename=&quot;mississipi_virginia_poblacion.png&quot; caption=&quot;Gráfico de la población de los estados de Mississippi y de Virginia&quot; %}\u003C\u002Fp\u003E\\n\u003Cp\u003EHacer cambios rápidos en el código y reanalizar nuestros datos es una parte fundamental del análisis exploratorio de datos (AED, o EDA por sus siglas en inglés). En vez de tratar de &quot;probar&quot; una hipótesis, el análisis exploratorio de datos nos ayuda a entender nuestros datos mejor y a hacernos preguntas sobre ellos. Para los historiadores el AED ofrece una forma de saber cuándo indagar más en un tema y cuando dejarlo a un lado, y esto es en el área en el que R sobresale.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"línea-de-operaciones\\\"\u003ELínea de operaciones\u003C\u002Fh2\u003E\\n\u003Cp\u003EAntes de ver \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E, tenemos que entender lo que es la línea de operaciones \u003Ccode\u003E%&gt;%\u003C\u002Fcode\u003E en R porque la vamos a utilizar mucho en nuestros ejemplos. Como decíamos, la línea de operaciones es parte del paquete  \u003Ca href=\\\"https:\u002F\u002Fcran.r-project.org\u002Fweb\u002Fpackages\u002Fmagrittr\u002Fvignettes\u002Fmagrittr.html\\\"\u003Emagittr\u003C\u002Fa\u003E creado por \u003Ca href=\\\"http:\u002F\u002Fstefanbache.dk\\\"\u003EStefan Milton Bache\u003C\u002Fa\u003E y \u003Ca href=\\\"http:\u002F\u002Fhadley.nz\u002F\\\"\u003EHadley Wickham\u003C\u002Fa\u003E y está incluida en tidyverse. Su nombre es un homenaje al pintor surrealista Rene Magritte y su famosa obra &quot;\u003Ca href=\\\"https:\u002F\u002Fhistoria-arte.com\u002Fobras\u002Fla-traicion-de-las-imagenes\\\"\u003ELa traición de las imágenes\u003C\u002Fa\u003E&quot;, que muestra una pipa con las palabras &quot;esto no es una pipa&quot; debajo, en francés.\u003C\u002Fp\u003E\\n\u003Cp\u003ELa línea de operaciones te permite pasar lo que está a su izquierda como la primera variable en una función especificada a la derecha. Aunque pueda parecer extraño al principio, una vez que lo aprendas verás que hace tu código más fácil de leer al evitar declaraciones anidadas. No te preocupes si esto te resulta un poco complicado ahora. Será más fácil una vez que trabajemos con ejemplos.\u003C\u002Fp\u003E\\n\u003Cp\u003EDigamos que nos interesa saber la raíz cuadrada del valor de cada población y luego queremos sumar todas las raíces cuadradas antes de calcular la media. Obviamente, esto no es una medida útil pero demuestra cuán rápido puede complicarse la lectura del código de R. Normalmente, anidaríamos las siguientes declaraciones:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Emean(sum(sqrt(importacion_poblacion_estados_eeuu$poblacion)))\\n\\n## [1] 1256925\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EComo ves, con tantos comandos anidados es difícil recordar cuántos paréntesis necesitas y hace que el código sea complicado de leer. Para mitigar esto algunas personas crean vectores temporales entre la llamada a cada función.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Calcular la raíz cuadrada de la población de cada estado\\nvector_raiz_cuadrada_poblacion_estados &lt;- sqrt(importacion_poblacion_estados_eeuu$poblacion)\\n\\n# Calcular la suma de las raíces cuadradas de la variable temporal\\nsuma_del_vector_raices_cuadradas_poblacion_estados &lt;- sum(vector_raiz_cuadrada_poblacion_estados)\\n\\n# Calcular la media de la variable temporal\\nmedia_suma_del_vector_raices_cuadradas_poblacion_estados &lt;- mean(suma_del_vector_raices_cuadradas_poblacion_estados)\\n\\n# Mostrar la mediana\\nmedia_suma_del_vector_raices_cuadradas_poblacion_estados\\n\\n## [1] 1256925\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EAunque vas a obtener la misma respuesta, esto es mucho más legible. Sin embargo, puede llenar tu espacio de trabajo con basura si olvidas borrar los vectores temporales. La línea de operaciones hace todo esto por ti. Aquí está el mismo código con la línea de operador \u003Cem\u003Epipe\u003C\u002Fem\u003E:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eimportacion_poblacion_estados_eeuu$poblacion%&gt;%sqrt%&gt;%sum%&gt;%mean\\n\\n## [1] 1256925\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EEsto es mucho más fácil de leer e incluso lo podrías hacer más claro escribiéndolo en diferentes líneas\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Asegúrate de poner el operador al final de la línea\\nimportacion_poblacion_estados_eeuu$poblacion%&gt;%\\n  sqrt%&gt;%\\n  sum%&gt;%\\n  mean\\n\\n## [1] 1256925\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EPor favor, nota que los vectores o marcos de datos que la línea de operación crea son descartados cuando se completa la operación. Si quieres guardarlos, tienes que pasarlos a una nueva variable:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Evector_raiz_y_suma_permanente_poblacion_estados &lt;- importacion_poblacion_estados_eeuu$poblacion%&gt;%sqrt%&gt;%sum%&gt;%mean\\nvector_raiz_y_suma_permanente_poblacion_estados\\n\\n## [1] 1256925\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch2 id=\\\"necesitamos-un-nuevo-conjunto-de-datos\\\"\u003ENecesitamos un nuevo conjunto de datos\u003C\u002Fh2\u003E\\n\u003Cp\u003EAhora que entendemos la línea de operaciones, estamos preparados para empezar a mirar y administrar otro conjunto de datos. Desafortunadamente, para los historiadores, solo hay unos pocos conjuntos disponibles - ¡a lo mejor tú nos puedas ayudar a cambiar esto haciendo los tuyos públicos! Aquí contamos con el paquete \u003Ca href=\\\"https:\u002F\u002Fcran.r-project.org\u002Fweb\u002Fpackages\u002Fhistorydata\u002Findex.html\\\"\u003Ehistory data\u003C\u002Fa\u003E (datos históricos) creado por \u003Ca href=\\\"https:\u002F\u002Flincolnmullen.com\\\"\u003ELincoln Mullen\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003EVamos a instalar y cargar el paquete:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Instalar el paquete historydata\\ninstall.packages(&quot;historydata&quot;)\\n\\n# Cargar el paquete historydata\\nlibrary(historydata)\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EEste paquete contiene ejemplos de conjuntos de datos históricos - el ejemplo anterior con datos del censo del EEUU fue tomado de este paquete (y modificado por la traductora). A lo largo de este tutorial, vamos a trabajar con el conjunto de \u003Ccode\u003Eearly_colleges\u003C\u002Fcode\u003E (primeras_universidades) que contiene datos sobre las universidades fundadas antes de 1848.[^4] Lo primero que vamos a hacer es cargar los datos y leerlos:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Asegúrate de que has instalado y cargado el paquete historydata antes de nada\\n\\ndata(early_colleges)\\nearly_colleges\\n\\n# A tibble: 65 x 6\\n   college                original_name         city          state established sponsorship\\n   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n 1 Harvard                NA                    Cambridge     MA           1636 Congregational; after 1805 …\\n 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican\\n 3 Yale                   NA                    New Haven     CT           1701 Congregational\\n 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational\\n 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian\\n 6 Columbia               King&#39;s College        New York      NY           1754 Anglican\\n 7 Brown                  NA                    Providence    RI           1765 Baptist\\n 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed\\n 9 Dartmouth              NA                    Hanover       NH           1769 Congregational\\n10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EComo puedes ver, este conjunto de datos contiene el nombre actual de la universidad (\u003Cem\u003Eoriginal_name\u003C\u002Fem\u003E), la ciudad (\u003Cem\u003Ecity\u003C\u002Fem\u003E) y el estado (\u003Cem\u003Estate\u003C\u002Fem\u003E) en que fue fundada, la fecha en que se fundó (\u003Cem\u003Eestablished\u003C\u002Fem\u003E), y la entidad responsable de su patrocinio (\u003Cem\u003Esponsorship\u003C\u002Fem\u003E). Como ya hemos dicho, antes de poder trabajar con un conjunto de datos, es importante pensar en cómo organizar los datos. Veamos si alguno de estos datos no está en formato &quot;limpio&quot; (\u003Cem\u003E&quot;tidy&quot;\u003C\u002Fem\u003E). ¿Puedes ver alguna celda que no concuerde con los tres criterio de datos limpios?\u003C\u002Fp\u003E\\n\u003Cp\u003ESi piensas que se trata deel patrocinio de Harvard, estás en lo cierto. Además de señalar el patrocinio original, también menciona que cambió de patrocinador en 1805. Normalmente uno quiere mantener toda la información posible sobre los datos, pero para propósitos de este tutorial, vamos a cambiar la columna para tener solo el patrocinador inicial.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges[1,6] &lt;- &quot;Congregational&quot;\\nearly_colleges\\n\\n# A tibble: 65 x 6\\n   college                original_name         city          state established sponsorship\\n   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n 1 Harvard                NA                    Cambridge     MA           1636 Congregational\\n 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican\\n 3 Yale                   NA                    New Haven     CT           1701 Congregational\\n 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational\\n 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian\\n 6 Columbia               King&#39;s College        New York      NY           1754 Anglican\\n 7 Brown                  NA                    Providence    RI           1765 Baptist\\n 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed\\n 9 Dartmouth              NA                    Hanover       NH           1769 Congregational\\n10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EAhora que tenemos nuestros datos en formato limpio, podemos formatearlos a través del paquete \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"¿qué-es-dplyr\\\"\u003E¿Qué es Dplyr?\u003C\u002Fh2\u003E\\n\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fcran.rstudio.com\u002Fweb\u002Fpackages\u002Fdplyr\u002Fvignettes\u002Fdplyr.html\\\"\u003EDplyr\u003C\u002Fa\u003E es otra parte de tidyverse que proporciona funciones para manipular y transformar tu datos. Dado que nuestros datos van a seguir estando ordenados (\u003Cem\u003Etidy\u003C\u002Fem\u003E), solamente necesitamos un conjunto pequeño de herramientas para explorarlo. Comparándolo con el R Base, el uso de \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E es más rápido y garantiza que si los datos introducidos (\u003Cem\u003Einput\u003C\u002Fem\u003E) están ordenados los datos que obtendremos (\u003Cem\u003Eoutput\u003C\u002Fem\u003E) también lo estarán. Quizás de manera más importante, \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E hace nuestro código fácil de leer y utiliza &quot;verbos&quot; que son, en su mayoría, intuitivos (para el hablante de inglés). Cada función en \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E corresponde a estos verbos, siendo los cinco principales filtrar (\u003Ccode\u003Efilter\u003C\u002Fcode\u003E), seleccionar (\u003Ccode\u003Eselect\u003C\u002Fcode\u003E), ordenar (\u003Ccode\u003Earrange\u003C\u002Fcode\u003E), mutar (\u003Ccode\u003Emutate\u003C\u002Fcode\u003E) y resumir (\u003Ccode\u003Esummarise\u003C\u002Fcode\u003E - con ortografía de inglés británico- o \u003Ccode\u003Esummarize\u003C\u002Fcode\u003E - con ortografía de inglés de EEUU-). Vamos a ver cada una de ellas para entender su funcionamiento en la práctica.\u003C\u002Fp\u003E\\n\u003Ch3 id=\\\"select-seleccionar\\\"\u003E\u003Ccode\u003Eselect\u003C\u002Fcode\u003E (seleccionar)\u003C\u002Fh3\u003E\\n\u003Cp\u003ESi miramos el conjunto \u003Ccode\u003Eearly_colleges\u003C\u002Fcode\u003E (primeras_universidades), podemos ver que hay muchos &quot;NA&quot; en la columna de nombres originales. NA significa que los datos no están disponibles (del inglés \u003Cem\u003Enot available\u003C\u002Fem\u003E), y quizás queramos ver nuestros datos sin esta columna. La función \u003Ccode\u003Eselect()\u003C\u002Fcode\u003E de \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E nos posibilita esto precisamente. Toma el marco de datos que quieres manipular como el primer argumento, seguido de la lista indicando qué columnas queremos mantener:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003E# Deshazte de la columna de nombres originales (&quot;original_name&quot;) usando select()\\n# Nota que no tienes que añadir el símbolo $ (dólar) al nombre de la columna al final de early_colleges porque `dplyr` asume que &quot;,&quot; (una coma) representa Y (AND en inglés) automáticamente\\n\\nselect(early_colleges, college, city, state, established, sponsorship)\\n\\n# A tibble: 65 x 5\\n   college                city          state established sponsorship\\n   &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n 1 Harvard                Cambridge     MA           1636 Congregational\\n 2 William and Mary       Williamsburg  VA           1693 Anglican\\n 3 Yale                   New Haven     CT           1701 Congregational\\n 4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\\n 5 Princeton              Princeton     NJ           1746 Presbyterian\\n 6 Columbia               New York      NY           1754 Anglican\\n 7 Brown                  Providence    RI           1765 Baptist\\n 8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\\n 9 Dartmouth              Hanover       NH           1769 Congregational\\n10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EEscribamos también esto mismo usando la línea de operador \u003Ccode\u003E%&gt;%\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges%&gt;%\\n    select(college, city, state, established, sponsorship)\\n\\n# A tibble: 65 x 5\\n   college                city          state established sponsorship\\n   &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n 1 Harvard                Cambridge     MA           1636 Congregational\\n 2 William and Mary       Williamsburg  VA           1693 Anglican\\n 3 Yale                   New Haven     CT           1701 Congregational\\n 4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\\n 5 Princeton              Princeton     NJ           1746 Presbyterian\\n 6 Columbia               New York      NY           1754 Anglican\\n 7 Brown                  Providence    RI           1765 Baptist\\n 8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\\n 9 Dartmouth              Hanover       NH           1769 Congregational\\n10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EHacer referencia a cada una de las columnas que queremos mantener para deshacernos de una es un tanto tedioso. Podemos usar el símbolo de restar (-) para indicar que queremos descartar una columna, con su nombre.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges%&gt;%\\n    select(-original_name)\\n\\n    # A tibble: 65 x 5\\n       college                city          state established sponsorship\\n       &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n     1 Harvard                Cambridge     MA           1636 Congregational\\n     2 William and Mary       Williamsburg  VA           1693 Anglican\\n     3 Yale                   New Haven     CT           1701 Congregational\\n     4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\\n     5 Princeton              Princeton     NJ           1746 Presbyterian\\n     6 Columbia               New York      NY           1754 Anglican\\n     7 Brown                  Providence    RI           1765 Baptist\\n     8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\\n     9 Dartmouth              Hanover       NH           1769 Congregational\\n    10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\\n    # ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch3 id=\\\"filter-filtrar\\\"\u003E\u003Ccode\u003Efilter\u003C\u002Fcode\u003E (filtrar)\u003C\u002Fh3\u003E\\n\u003Cp\u003ELa función \u003Ccode\u003Efilter()\u003C\u002Fcode\u003E hace lo mismo que la función \u003Ccode\u003Eselect\u003C\u002Fcode\u003E pero en vez de escoger el nombre de la columna, la podemos usar para filtrar filas usando un test de requisitos. Por ejemplo, podemos ver todas las universidades que existían antes del cambio de siglo:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges%&gt;%\\n    filter(established &lt; 1800)\\n\\n    # A tibble: 20 x 6\\n       college                  original_name         city           state established sponsorship\\n       &lt;chr&gt;                    &lt;chr&gt;                 &lt;chr&gt;          &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n     1 Harvard                  NA                    Cambridge      MA           1636 Congregational\\n     2 William and Mary         NA                    Williamsburg   VA           1693 Anglican\\n     3 Yale                     NA                    New Haven      CT           1701 Congregational\\n     4 Pennsylvania, Univ. of   NA                    Philadelphia   PA           1740 Nondenominational\\n     5 Princeton                College of New Jersey Princeton      NJ           1746 Presbyterian\\n     6 Columbia                 King&#39;s College        New York       NY           1754 Anglican\\n     7 Brown                    NA                    Providence     RI           1765 Baptist\\n     8 Rutgers                  Queen&#39;s College       New Brunswick  NJ           1766 Dutch Reformed\\n     9 Dartmouth                NA                    Hanover        NH           1769 Congregational\\n    10 Charleston, Coll. Of     NA                    Charleston     SC           1770 Anglican\\n    11 Hampden-Sydney           NA                    Hampden-Sydney VA           1775 Presbyterian\\n    12 Transylvania             NA                    Lexington      KY           1780 Disciples of Christ\\n    13 Georgia, Univ. of        NA                    Athens         GA           1785 Secular\\n    14 Georgetown               NA                    Washington     DC           1789 Roman Catholic\\n    15 North Carolina, Univ. of NA                    Chapel Hill    NC           1789 Secular\\n    16 Vermont, Univ. of        NA                    Burlington     VT           1791 Nondenominational\\n    17 Williams                 NA                    Williamstown   MA           1793 Congregational\\n    18 Tennessee, Univ. of      Blount College        Knoxville      TN           1794 Secular\\n    19 Union College            NA                    Schenectady    NY           1795 Presbyterian with Congre…\\n    20 Marietta                 NA                    Marietta       OH           1797 Congregational\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch3 id=\\\"mutate-mutar\\\"\u003E\u003Ccode\u003Emutate\u003C\u002Fcode\u003E (mutar)\u003C\u002Fh3\u003E\\n\u003Cp\u003EEl comando \u003Ccode\u003Emutate\u003C\u002Fcode\u003E nos permite añadir una columna al conjunto de datos. Ahora mismo, tenemos la ciudad y el estado en dos columnas diferentes. Podemos usar el comando de pegar (\u003Ccode\u003Epaste\u003C\u002Fcode\u003E) para combinar dos cadenas de caracteres y especificar un separador. Pongámoslas en una única columna llamada &quot;location&quot; (lugar):\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges%&gt;%mutate(location=paste(city,state,sep=&quot;,&quot;))\\n\\n# A tibble: 65 x 7\\n   college                original_name         city          state established sponsorship       location\\n   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;\\n 1 Harvard                NA                    Cambridge     MA           1636 Congregational    Cambridge,MA\\n 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican          Williamsburg,VA\\n 3 Yale                   NA                    New Haven     CT           1701 Congregational    New Haven,CT\\n 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational Philadelphia,PA\\n 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian      Princeton,NJ\\n 6 Columbia               King&#39;s College        New York      NY           1754 Anglican          New York,NY\\n 7 Brown                  NA                    Providence    RI           1765 Baptist           Providence,RI\\n 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed    New Brunswick,NJ\\n 9 Dartmouth              NA                    Hanover       NH           1769 Congregational    Hanover,NH\\n10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican          Charleston,SC\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003ERecuerda que \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E no guarda los datos ni manipula el original. Al contrario, crea marcos de datos temporales en cada paso. Si quieres guardarlos, tienes que crear una variable permanente con \u003Ccode\u003E&lt;-\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eprimeras_universidades_con_localizacion &lt;- early_colleges%&gt;%\\n  mutate(location=paste(city, state, sep=&quot;,&quot;))\\n\\n# Observa la nueva tabla con la localización añadida\\nprimeras_universidades_con_localizacion\\n\\n# A tibble: 65 x 7\\n   college                original_name         city          state established sponsorship       location\\n   &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;\\n 1 Harvard                NA                    Cambridge     MA           1636 Congregational    Cambridge,MA\\n 2 William and Mary       NA                    Williamsburg  VA           1693 Anglican          Williamsburg,VA\\n 3 Yale                   NA                    New Haven     CT           1701 Congregational    New Haven,CT\\n 4 Pennsylvania, Univ. of NA                    Philadelphia  PA           1740 Nondenominational Philadelphia,PA\\n 5 Princeton              College of New Jersey Princeton     NJ           1746 Presbyterian      Princeton,NJ\\n 6 Columbia               King&#39;s College        New York      NY           1754 Anglican          New York,NY\\n 7 Brown                  NA                    Providence    RI           1765 Baptist           Providence,RI\\n 8 Rutgers                Queen&#39;s College       New Brunswick NJ           1766 Dutch Reformed    New Brunswick,NJ\\n 9 Dartmouth              NA                    Hanover       NH           1769 Congregational    Hanover,NH\\n10 Charleston, Coll. Of   NA                    Charleston    SC           1770 Anglican          Charleston,SC\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch3 id=\\\"arrangeordenar\\\"\u003E\u003Ccode\u003Earrange\u003C\u002Fcode\u003E(ordenar)\u003C\u002Fh3\u003E\\n\u003Cp\u003ELa función \u003Ccode\u003Earrange\u003C\u002Fcode\u003E nos permite ordenar nuestras columnas de una nueva forma. Ahora mismo, las universidades están organizadas por año en orden ascendiente. Pongámoslas en el orden descendiente de fundación desde, en este caso, el fin de la guerra con México en 1848.[^5]\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges %&gt;%\\n   arrange(desc(established))\\n\\n# A tibble: 65 x 6\\n   college               original_name city        state established sponsorship\\n   &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\\n 1 Wisconsin, Univ. of   NA            Madison     WI           1848 Secular\\n 2 Earlham               NA            Richmond    IN           1847 Quaker\\n 3 Beloit                NA            Beloit      WI           1846 Congregational\\n 4 Bucknell              NA            Lewisburg   PA           1846 Baptist\\n 5 Grinnell              NA            Grinnell    IA           1846 Congregational\\n 6 Mount Union           NA            Alliance    OH           1846 Methodist\\n 7 Louisiana, Univ. of   NA            New Orleans LA           1845 Secular\\n 8 U.S. Naval Academy    NA            Annapolis   MD           1845 Secular\\n 9 Mississipps, Univ. of NA            Oxford      MI           1844 Secular\\n10 Holy Cross            NA            Worchester  MA           1843 Roman Catholic\\n# ... with 55 more rows\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch3 id=\\\"summarise-resumir\\\"\u003E\u003Ccode\u003Esummarise\u003C\u002Fcode\u003E (resumir)\u003C\u002Fh3\u003E\\n\u003Cp\u003ELa última función clave en \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E es \u003Ccode\u003Esummarise()\u003C\u002Fcode\u003E - en ortografía británica (con &#39;s&#39;) o en estadounidense (con &#39;z&#39;). \u003Ccode\u003Esummarise()\u003C\u002Fcode\u003E toma una función u operación y generalmente se usa para crear un \u003Cem\u003Edata frame\u003C\u002Fem\u003E que contiene los datos estadísticos de resumen y que podemos visualizar en forma de gráfico. Aquí la vamos a usar para calcular el año promedio en que se fundaron las universidades antes de 1848.\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eearly_colleges%&gt;%summarise(mean(established))\\n\\n# A tibble: 1 x 1\\n  `mean(established)`\\n                &lt;dbl&gt;\\n1            1809.831\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Ch2 id=\\\"poniéndolo-todo-junto\\\"\u003EPoniéndolo todo junto\u003C\u002Fh2\u003E\\n\u003Cp\u003EAhora que hemos aprendido los cinco verbos principales para \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E, podemos usarlos para crear rápidas visualizaciones de nuestros datos. Vamos a crear un gráfico de barras mostrando el número de universidades laicas y religiosas antes de la Guerra de EEUU de 1812[^6]:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Euniversidades_seculares_antes_1812 &lt;- early_colleges%&gt;%\\n  filter(established &lt; 1812)%&gt;%\\n  mutate(es_laica=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;si&quot;))\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003EPrimero, se ejecuta la función de filtrado para escoger aquellas universidades establecidas antes de 1812. Luego, en la función \u003Ccode\u003Emutate\u003C\u002Fcode\u003E la función interna \u003Ccode\u003Eifelse\u003C\u002Fcode\u003E (\u003Cem\u003Eif...else...\u003C\u002Fem\u003E o si...si no...) genera un test de verdadero (TRUE) o falso (FALSE) sobre los valores de la columna &quot;sponsorship&quot; y genera otra columna &quot;es_laica&quot; con los resultados; tal que &quot;si el valor en la columna no es igual a (\u003Ccode\u003E!=\u003C\u002Fcode\u003E) &quot;Secular&quot; añade un &quot;no&quot; en la nueva columna, si dice &quot;Secular&quot; añade un &quot;si&quot;, repitiendo la operación para cada fila, en este caso para cada universidad [N. de la T.].\u003C\u002Fp\u003E\\n\u003Cp\u003EAhora podemos visualizar los datos:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Eggplot(universidades_seculares_antes_1812) +\\n  geom_bar(aes(x=es_laica, fill=es_laica))+\\n  labs(title=&quot;Tipo de universidad antes de 1812&quot;, x=&quot;¿Es laica la universidad?&quot;, y=&quot;Recuento&quot;)\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E{% include figure.html filename=&quot;universidades_seculares_antes_1812.png&quot; caption=&quot;Número de universidades laicas y religiosas antes de la Guerra de 1812&quot; %}\u003C\u002Fp\u003E\\n\u003Cp\u003EDe nuevo, haciendo un cambio rápido en nuestro código, podemos también mirar el número de universidades laicas y religiosas después del comienzo de la Guerra de 1812:\u003C\u002Fp\u003E\\n\u003Cpre\u003E\u003Ccode\u003Euniversidades_seculares_despues_1812&lt;-early_colleges%&gt;%\\n  filter(established &gt; 1812)%&gt;%\\n  mutate(es_laica=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;si&quot;))\\n\\nggplot(universidades_seculares_despues_1812) +\\n  geom_bar(aes(x=es_laica, fill=es_laica))+\\n  labs(x=&quot;¿Es laica la universidad?&quot;, y=&quot;Recuento&quot;)\\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\\n\u003Cp\u003E{% include figure.html filename=&quot;universidades_seculares_despues_1812.png&quot; caption=&quot;Número de universidades laicas y religiosas después de la Guerra de 1812&quot; %}\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"conclusión\\\"\u003EConclusión\u003C\u002Fh2\u003E\\n\u003Cp\u003EEste tutorial debería darte una idea de cómo organizar y manipular tus datos en R. Más adelante quizás quieras visualizar tus datos de alguna otra forma. Te recomiendo que empieces por explorar el paquete \u003Ca href=\\\"https:\u002F\u002Fggplot2.tidyverse.org\u002F\\\"\u003Eggplot2\u003C\u002Fa\u003E (ver abajo) porque su conjunto de herramientas funciona muy bien con \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E. Además, puede que quieras examinar alguna otra función de las que viene con \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E para mejorar tus habilidades. En todo caso, esto te proporciona una buena base sobre la que construir para abarcar algunos de los problemas comunes que encontrarás.\u003C\u002Fp\u003E\\n\u003Ch2 id=\\\"recursos-adicionales-en-español\\\"\u003ERecursos adicionales en español\u003C\u002Fh2\u003E\\n\u003Cul\u003E\\n\u003Cli\u003E\u003Cp\u003E\u003Ca href=\\\"https:\u002F\u002Fswcarpentry.github.io\u002Fr-novice-gapminder-es\u002F\\\"\u003ER para Análisis Científicos Reproducibles\u003C\u002Fa\u003E de Software Carpentry (2018) tiene más información sobre cómo utilizar \u003Ccode\u003Edplyr\u003C\u002Fcode\u003E para tus datos.\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Cp\u003EPara aprender más sobre el paquete &#39;ggplot2&#39; puedes consultar la sección &quot;\u003Ca href=\\\"https:\u002F\u002Fes.r4ds.hadley.nz\u002Fvisualizaci%C3%B3n-de-datos.html\\\"\u003EVisualización de datos\u003C\u002Fa\u003E&quot; en el libro \u003Cem\u003ER para Ciencia de Datos\u003C\u002Fem\u003E de Hadley Wickham y Garrett Grolemund.\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003Cli\u003E\u003Cp\u003ETanto la \u003Cem\u003E\u003Ca href=\\\"https:\u002F\u002Fwww.inei.gob.pe\u002Fmedia\u002FMenuRecursivo\u002Fmetodologias\u002Flibro.pdf\\\"\u003EGuía  para  la  Presentación  de  Gráficos  Estadísticos\u003C\u002Fa\u003E,\u003C\u002Fem\u003E del Instituto  Nacional  de Estadística e Informática (2009) así como la \u003Ca href=\\\"http:\u002F\u002Facademica-e.unavarra.es\u002Fbitstream\u002Fhandle\u002F2454\u002F15785\u002FGram%C3%A1tica.pdf?sequence=1\\\"\u003E\u003Cem\u003EGramática de las gráficas: Pistas para mejorar las representaciones de datos\u003C\u002Fem\u003E\u003C\u002Fa\u003E de Joaquín Sevilla Moróder ofrecen explicaciones de cómo presentar tus datos y errores a evitar.\u003C\u002Fp\u003E\\n\u003C\u002Fli\u003E\\n\u003C\u002Ful\u003E\\n\u003Cp\u003E[^1]: En el tutorial original se hace referencia al libro &quot;\u003Ca href=\\\"https:\u002F\u002Fwww.springer.com\u002Fus\u002Fbook\u002F9780387245447\\\"\u003EThe Grammar of Graphics\u003C\u002Fa\u003E&quot; (2005) de Wilkinson.\u003C\u002Fp\u003E\\n\u003Cp\u003E[^2]: Este listado contiene el censo de la población de cada estado desde 1790, es decir, a partir de la formación de los Estados Unidos de América. De esta manera, el listado comienza con 15 estados (los 13 primeros estados eran ya parte del país desde su \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FDeclaraci%C3%B3n_de_Independencia_de_los_Estados_Unidos\\\"\u003Eindependencia en 1776\u003C\u002Fa\u003E, pero no se ratificó su admisión hasta la \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FConstituci%C3%B3n_de_los_Estados_Unidos\\\"\u003EConstitución de 1787\u003C\u002Fa\u003E), los del noreste y parte del sureste, a los que se van añadiendo territorios (que luego se convertirán en estado) a lo largo de los siglos XIX y XX, hasta llegar a la actual división territorial del país: \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FAnexo:Estados_y_Territorios_de_los_Estados_Unidos#Lista_de_estados\\\"\u003E50 estados\u003C\u002Fa\u003E, un \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FAnexo:Estados_y_Territorios_de_los_Estados_Unidos#Distrito_Federal\\\"\u003Edistrito federal\u003C\u002Fa\u003E y varios \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FAnexo:Estados_y_Territorios_de_los_Estados_Unidos#Territorios\\\"\u003Eterritorios no incorporados\u003C\u002Fa\u003E (Puerto Rico aparece en este censo pero no es un estado como tal, sino un \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FEstado_libre_asociado\\\"\u003Eestado libre asociado\u003C\u002Fa\u003E o territorio). Se han traducido los datos originales (en inglés) al español. [N. de la T.]\u003C\u002Fp\u003E\\n\u003Cp\u003E[^3]: \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FHistoria_territorial_de_los_Estados_Unidos\\\"\u003ELa migración hacia el oeste de los Estados Unidos\u003C\u002Fa\u003E se dio durante el siglo XIX a partir de la compra de Luisiana (a Francia) y hasta su llegada a la costa Pacífico, despojando a los norteamericanos nativos de sus tierras mediante la violencia. Nótese, además, que California fue incorporada a los Estados Unidos en 1850, tras su cesión por parte de México al finalizar la guerra entre ambos países (1846-1848) por el \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FTratado_de_Guadalupe_Hidalgo\\\"\u003ETratado de Guadalupe Hidalgo\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003E[^4]: No traducimos estos conjunto pero, por suerte, los datos son bastante intuitivos al tratarse de nombres propios, ciudades, años e iglesias cuyos nombres son cognados entre inglés y español (Anglican por anglicana, Presbyterian por presbiteriana, etc.) [N.de la T.]\u003C\u002Fp\u003E\\n\u003Cp\u003E[^5]: La también llamada \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FIntervenci%C3%B3n_estadounidense_en_M%C3%A9xico\\\"\u003EGuerra Mexico-Americana\u003C\u002Fa\u003E fue la guerra librada entre los Estados Unidos y México desde 1846 hasta la firma del \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FTratado_de_Guadalupe_Hidalgo\\\"\u003ETratado de Guadalupe Hidalgo\u003C\u002Fa\u003E en 1848 y la \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FCesi%C3%B3n_mexicana\\\"\u003Ecesión mexicana\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\\n\u003Cp\u003E[^6]: La \u003Ca href=\\\"https:\u002F\u002Fes.wikipedia.org\u002Fwiki\u002FGuerra_anglo-estadounidense_de_1812\\\"\u003EGuerra de 1812\u003C\u002Fa\u003E, o guerra anglo-estadounidense, enfrentó a los EEUU contra el Reino Unido al tratar los primeros de conquistar los territorios coloniales de los segundos. Finalizó en 1815.\u003C\u002Fp\u003E\\n\"}"}</script></div>
	</body>
</html>
