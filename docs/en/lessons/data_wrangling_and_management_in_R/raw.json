{"metadata":{"title":"Data Wrangling and Management in R","authors":["Nabeel Siddiqui"],"date":"2017-07-31T00:00:00.000Z","reviewers":["Lauren Tilton","Ryan Deschamps"],"editors":["Ian Milligan"],"difficulty":2,"collection":"lessons","activity":"transforming","topics":["data-manipulation","data-management","distant-reading"],"abstract":"This tutorial explores how scholars can organize 'tidy' data, understand R packages to manipulate data, and conduct basic data analysis.","layout":"lesson","review-ticket":"https://github.com/programminghistorian/ph-submissions/issues/60","redirect_from":"/lessons/data-wrangling-and-management-in-R","avatar_alt":"Bar of soap","doi":"10.46430/phen0063"},"html_body":"<p>{% include toc.html %}</p>\n<h1 id=\"assumptions\">Assumptions</h1>\n<p>This lesson makes a few assumptions about your understanding of R. If\nyou have not completed the <a href=\"/lessons/r-basics-with-tabular-data\">R Basics with Tabular\nData</a>\nlesson, I suggest you complete that first. Having a background in\nanother programming language will also be beneficial. If you need a\nplace to start, I recommend working through the <em>Programming\nHistorian&#39;s</em> excellent Python tutorials.</p>\n<h1 id=\"lesson-goals\">Lesson Goals</h1>\n<p>By the end of this lesson, you will:</p>\n<ol>\n<li>Know how to organize data to be &quot;tidy&quot; and why this is important.</li>\n<li>Understand the dplyr package and use it to manipulate and wrangle\nwith data.</li>\n<li>Become acquainted with the pipe operator in R and observe how it can\nassist you in creating more readable code.</li>\n<li>Learn to work through some basic examples of data manipulation to\ngain a foundation in exploratory data analysis.</li>\n</ol>\n<h1 id=\"introduction\">Introduction</h1>\n<p>Data you find &quot;in the wild&quot; will rarely be in a format necessary for\nanalysis, and you will need to manipulate it before exploring the\nquestions you are interested in. This may take more time than doing the\nanalysis itself! In this tutorial, we will learn some basic techniques\nfor manipulating, managing, and wrangling with our data in R.\nSpecifically, we will rely on the philosophy of <a href=\"https://www.jstatsoft.org/article/view/v059i10\">&quot;tidy\ndata&quot;</a> as articulated by\nHadley Wickham.</p>\n<p>According to <a href=\"http://hadley.nz/\">Wickham</a>, data is &quot;tidy&quot; when it meets\nthree key criteria:</p>\n<ol>\n<li>Each observation is in a row.</li>\n<li>Each variable is in a column.</li>\n<li>Each value has its own cell.</li>\n</ol>\n<p>Being observant of these criteria allows us to recognize when data is\norganized or unorganized. It also provides us a standardized schema and\nset of tools for cleaning up some of the most common ways that datasets\nare &quot;messy:&quot;</p>\n<ol>\n<li>Column headers are values, not variable names.</li>\n<li>Multiple variables are stored in one column.</li>\n<li>Variables are stored in both rows and columns.</li>\n<li>Multiple types of observational units are stored in the same table.</li>\n<li>A single observational unit is stored in multiple tables.</li>\n</ol>\n<p>Perhaps most importantly, keeping our data in this format allows us to\nuse a collection of packages in the\n<a href=\"http://tidyverse.org/\">&quot;tidyverse,&quot;</a> which are designed to specifically\nwork with tidy data. By making sure that our input and output are tidy,\nwe only have to use a small set of tools to solve a large number of\nquestions. In addition, we can combine, manipulate, and split tidy\ndatasets as we see fit.</p>\n<p>In this tutorial, we will be focusing on the\n<a href=\"https://cran.r-project.org/web/packages/dplyr/index.html\">dplyr</a>\npackage of the tidyverse, but it is worth briefly mentioning some others\nwe will be running into:</p>\n<p><a href=\"http://magrittr.tidyverse.org\"><strong>magittr</strong></a>--This package gives us\naccess to the forward pipe operator and makes our code easier to read.\n<a href=\"http://ggplot2.tidyverse.org/\"><strong>ggplot2</strong></a>--This package utilizes the\n<a href=\"http://www.springer.com/us/book/9780387245447\">&quot;Grammar of Graphics&quot;</a>\nto provide an easy way to visualize our data.\n<a href=\"http://readr.tidyverse.org\"><strong>readr</strong></a>--This package makes available a\nfaster and more streamlined method of importing rectangular data, such\nas csv files.\n<a href=\"http://tibble.tidyverse.org/\"><strong>tibble</strong></a>--This package provides us\naccess to a reconceptualization of data frames that are easier to work\nwith and print.</p>\n<p>If you have not already done so, you should install and load the\n&quot;tidyverse&quot; before beginning. In addition, make sure that you have the\n<a href=\"https://cran.rstudio.com/\">latest version of R</a> and the <a href=\"https://www.rstudio.com/products/rstudio/download/\">latest version\nof R Studio</a>\ninstalled for your respective platform.</p>\n<p>Copy the following code into RStudio. To run it, you need to highlight\nthe lines and press Ctrl+Enter (Command+Enter on Mac OS):</p>\n<pre><code># Install tidyverse libraries and load it\n# Do not worry if this takes a while\n\ninstall.packages(&quot;tidyverse&quot;)\nlibrary(tidyverse)\n</code></pre>\n<h1 id=\"an-example-of-dplyr-in-action\">An Example of dplyr in Action</h1>\n<p>Let&#39;s go through an example to see how dplyr can aid us as historians by\ninputting U.S. decennial census data from 1790 to 2010. Download the\ndata by <a href=\"/assets/introductory_state_example.csv\">clicking\nhere</a>\nand place it in the folder that you will use to work through the examples\nin this tutorial.</p>\n<p>Since the data is in a csv file, we are going to use the read_csv()\ncommand in tidyverse&#39;s\n<a href=\"https://cran.r-project.org/web/packages/readr/vignettes/readr.html\">readr</a>\npackage.</p>\n<p>The read_csv function takes the path of a file we want to import from\nas a variable so make sure that you have it set up correctly.</p>\n<pre><code># Import CSV File and save to us_state_populations_import\n# Make sure you set the path of the file correctly\nus_state_populations_import&lt;-read_csv(&quot;introductory_state_example.csv&quot;)\n</code></pre>\n<p>After you import the data, you will notice that there are three columns:\none for the population, one for the year, and one for the state. This\ndata is already in a tidy format providing us a multitude of options for\nfurther exploration.</p>\n<p>For this example, let&#39;s visualize the population growth of California and\nNew York to gain a better understanding of Western migration. We will\nuse dplyr to filter our data so that it only contains information about\nthe states we are interested in, and we will use ggplot2 to visualize\nthis information. This exercise is just to provide you a taste of what\ndplyr can do, so don&#39;t worry if you don&#39;t understand the code at this\ntime.</p>\n<pre><code># Filter to California and New York states only\ncalifornia_and_new_york_state_populations&lt;-us_state_populations_import %&gt;%\n  filter(state %in% c(&quot;California&quot;, &quot;New York&quot;))\n\n# Plot California and New York State Populations\nggplot(data=california_and_new_york_state_populations, aes(x=year, y=population, color=state)) +\n  geom_line() +\n  geom_point()\n</code></pre>\n<p>{% include figure.html filename=&quot;california_new_york_population.png&quot; caption=&quot;Graph of California and New York population&quot; %}</p>\n<p>As we can see, the population of California has grown considerably\ncompared to New York. While this particular example may seem obvious\ngiven the history of U.S. migration, the code itself provides us a\nfoundation that we can build on to ask a multitude of similar questions.\nFor instance, with a quick change of code, we can create a similar graph\nwith two different states such as Mississippi and Virginia.</p>\n<pre><code># Filter to Mississippi and Virginia\nmississippi_and_virginia_state_populations&lt;-us_state_populations_import %&gt;%\n  filter(state %in% c(&quot;Mississippi&quot;, &quot;Virginia&quot;))\n\n# Plot California and New York State Populations\nggplot(data=mississippi_and_virginia_state_populations, aes(x=year, y=population, color=state)) +\n  geom_line() +\n  geom_point()\n</code></pre>\n<p>{% include figure.html filename=&quot;mississippi_virginia_population.png&quot; caption=&quot;Graph of Mississippi and Virginia population&quot; %}</p>\n<p>Quickly making changes to our code and reanalyzing our data is a\nfundamental part of exploratory data analysis (EDA). Rather than trying\nto &quot;prove&quot; a hypothesis, exploratory data analysis helps us understand\nour data better and ask questions about it. For historians, EDA provides\nan easy means of knowing when to dig deeper into a subject and when to\nstep back, and it is an area where R excels.</p>\n<h1 id=\"pipe-operator\">Pipe Operator</h1>\n<p>Before looking at dplyr, we need to go over the pipe operator (%&gt;%)\nin R since we will often run into it in our examples. As mentioned\nearlier, the pipe operator is part of the\n<a href=\"https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html\">magrittr</a>\npackage created by <a href=\"http://stefanbache.dk/\">Stefan Milton Bache</a> and\n<a href=\"http://hadley.nz/\">Hadley Wickham</a> and is included in the tidyverse.\nIts name is an homage to surrealest painter Rene Magritte, whose &quot;The\nTreachery of Images&quot; famously depicted a pipe with the words &quot;this is\nnot a pipe&quot; underneath in French.</p>\n<p>The pipe operator allows you to pass what is to the left of the pipe as\nthe first variable in a function specified on the right. Although it may\nseem strange at first, once you learn it, you will find that it makes\nyour code more readable by avoiding nested statements. Don&#39;t worry if\nall this is a little confusing right now. It will become more clear as\nwe go through the examples.</p>\n<p>Let&#39;s say that we are interested in getting the square root of each\npopulation value and then summing all the square roots before getting\nthe mean. Obviously, this isn&#39;t a useful measurement, but it demonstrates\njust how quickly R code can become difficult to read. Normally, we would\nnest such statements:</p>\n<pre><code>mean(sum(sqrt(us_state_populations_import$population)))\n\n## [1] 1256925\n</code></pre>\n<p>As you can see, with enough nested commands, it is hard to remember how\nmany parenthesis you need and makes the code awkward to read. To mitigate\nthis, some people may create temporary vectors in between each function\ncall.</p>\n<pre><code># Get square root of all the state populations\n\nsqrt_state_populations_vector&lt;-sqrt(us_state_populations_import$population)\n\n# Get sum of all the sqrts of the temporary variable\n\nsum_sqrt_state_populations_vector&lt;-sum(sqrt_state_populations_vector)\n\n# Get mean of the temporary variable\n\nmean_sum_sqrt_state_populations_vector&lt;-mean(sum_sqrt_state_populations_vector)\n\n# Display the mean\n\nmean_sum_sqrt_state_populations_vector\n\n## [1] 1256925\n</code></pre>\n<p>Although you get the same answer, this is a lot more readable. However,\nit can quickly clutter your workspace if you forget to delete the\ntemporary vectors. The pipe operator does all this for you. Here is the\nsame code using the pipe operator.</p>\n<pre><code>us_state_populations_import$population%&gt;%sqrt%&gt;%sum%&gt;%mean\n\n## [1] 1256925\n</code></pre>\n<p>This is a lot easier to read, and you could make it even more clear by\nwriting this on multiple lines.</p>\n<pre><code># Make sure to put the operator at the end of the line\nus_state_populations_import$population%&gt;%\n    sqrt%&gt;%\n    sum%&gt;%\n    mean\n\n## [1] 1256925\n</code></pre>\n<p>Please note that the vectors or data frames that the pipe operator\ncreates are discarded after the operation is complete. If you want to\nstore them, you should pass them to a new variable.</p>\n<pre><code>permanent_sqrt_and_sum_state_populations_vector &lt;- us_state_populations_import$population%&gt;%sqrt%&gt;%sum%&gt;%mean\npermanent_sqrt_and_sum_state_populations_vector\n\n## [1] 1256925\n</code></pre>\n<h1 id=\"we-need-a-new-dataset\">We Need a New Dataset</h1>\n<p>Now that we have an understanding of the pipe operator, we are ready to\nbegin looking at and wrangling with some data. Unfortunately, for\nhistorians, there are only a few easily available datasets--perhaps you\ncan help change this by making yours available to the public! We are\ngoing to rely on the <a href=\"https://www.google.com/search?q=cran%20historydata\">history\ndata</a> package\ncreated by <a href=\"http://lincolnmullen.com/\">Lincoln Mullen</a>.</p>\n<p>Lets go ahead and install and load the package:</p>\n<pre><code># Install historydata package\ninstall.packages(&quot;historydata&quot;)\n\n# Load historydata package\nlibrary(historydata)\n</code></pre>\n<p>This packages contains samples of historical datasets--the earlier U.S.\nCensus data sample was taken from this package. Throughout this\ntutorial, we are specifically going to work with the early_colleges\ndataset that contains data about colleges founded before 1848. Lets\nstart by loading the data and view it.</p>\n<pre><code># Make sure you have installed the historydata package and loaded it before this\n\ndata(early_colleges)\nearly_colleges\n\n## # A tibble: 65 x 6\n##    college                original_name         city          state\n##    &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;\n##  1 Harvard                &lt;NA&gt;                  Cambridge     MA\n##  2 William and Mary       &lt;NA&gt;                  Williamsburg  VA\n##  3 Yale                   &lt;NA&gt;                  New Haven     CT\n##  4 Pennsylvania, Univ. of &lt;NA&gt;                  Philadelphia  PA\n##  5 Princeton              College of New Jersey Princeton     NJ\n##  6 Columbia               King&#39;s College        New York      NY\n##  7 Brown                  &lt;NA&gt;                  Providence    RI\n##  8 Rutgers                Queen&#39;s College       New Brunswick NJ\n##  9 Dartmouth              &lt;NA&gt;                  Hanover       NH\n## 10 Charleston, Coll. Of   &lt;NA&gt;                  Charleston    SC\n##    established sponsorship\n##          &lt;int&gt; &lt;chr&gt;\n##  1        1636 Congregational; after 1805 Unitarian\n##  2        1693 Anglican\n##  3        1701 Congregational\n##  4        1740 Nondenominational\n##  5        1746 Presbyterian\n##  6        1754 Anglican\n##  7        1765 Baptist\n##  8        1766 Dutch Reformed\n##  9        1769 Congregational\n## 10        1770 Anglican\n## # ... with 55 more rows\n</code></pre>\n<p>As you can observe, this dataset contains the current name of the college, its\noriginal name, the city and state where it was founded, when the college was\nestablished, and its sponsorship. As we discussed earlier, before we can\nwork with a dataset, it is important to think about how to organize the\ndata. Let&#39;s see if any of our data is not in a &quot;tidy&quot; format. Do you see\nany cells that do not match the three criteria for tidy data?</p>\n<p>If you guessed the sponsorship of Harvard, you are correct. In addition\nto noting the original sponsorship, it also mentions that it changed\nsponsorship in 1805. Usually, you want to keep as much information about\nyour data that you can, but for the purposes of this tutorial, we are\ngoing to change the column to only have the original sponsorship.</p>\n<pre><code>early_colleges[1,6] &lt;- &quot;Congregational&quot;\nearly_colleges\n\n## # A tibble: 65 x 6\n##    college                original_name         city          state\n##    &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;\n##  1 Harvard                &lt;NA&gt;                  Cambridge     MA\n##  2 William and Mary       &lt;NA&gt;                  Williamsburg  VA\n##  3 Yale                   &lt;NA&gt;                  New Haven     CT\n##  4 Pennsylvania, Univ. of &lt;NA&gt;                  Philadelphia  PA\n##  5 Princeton              College of New Jersey Princeton     NJ\n##  6 Columbia               King&#39;s College        New York      NY\n##  7 Brown                  &lt;NA&gt;                  Providence    RI\n##  8 Rutgers                Queen&#39;s College       New Brunswick NJ\n##  9 Dartmouth              &lt;NA&gt;                  Hanover       NH\n## 10 Charleston, Coll. Of   &lt;NA&gt;                  Charleston    SC\n##    established sponsorship\n##          &lt;int&gt; &lt;chr&gt;\n##  1        1636 Congregational\n##  2        1693 Anglican\n##  3        1701 Congregational\n##  4        1740 Nondenominational\n##  5        1746 Presbyterian\n##  6        1754 Anglican\n##  7        1765 Baptist\n##  8        1766 Dutch Reformed\n##  9        1769 Congregational\n## 10        1770 Anglican\n## # ... with 55 more rows\n</code></pre>\n<p>Now that we have our data in a tidy format, we can shape it through the\ndplyr package.</p>\n<h1 id=\"what-is-dplyr\">What is Dplyr?</h1>\n<p><a href=\"https://cran.rstudio.com/web/packages/dplyr/vignettes/dplyr.html\">Dplyr</a>\nis another part of the tidyverse that provides functions for\nmanipulating and transforming your data. Because we are keeping our data\n&quot;tidy,&quot; we only need a small set of tools to explore our data. Compared\nto base R, using dplyr is often faster, and guarantees that if our\ninput is tidy then our output will also be tidy. Perhaps most importantly,\ndplyr makes our code easier to read and utilizes &quot;verbs&quot; that are, in\nmost cases, intuitive. Each function in dplyr corresponds to these verbs,\nwith the five key ones being filter, select, arrange, mutate, and\nsummarise--dplyr uses the British spelling. Let&#39;s go through each of them\nindividually to see how they work in practice.</p>\n<h3 id=\"select\">Select</h3>\n<p>If we look at the early_colleges data, we can observe that there are a\nlot of NA&#39;s in the original names column. NA signifies that the data is\nnot available, and we may want to view our data with this column\nremoved. dplyr&#39;s select() function gives us the ability to do this. It\ntakes the data frame you want to manipulate as the first argument, followed by a\nlist signifying which columns you would like to keep:</p>\n<pre><code># Remove the original names column using select()\n# Note that you do not have to append the column name with a $ to the end of early_colleges since\n# dplyr automatically assumes that a &quot;,&quot; represents AND\n\nselect(early_colleges, college, city, state, established, sponsorship)\n\n## # A tibble: 65 x 5\n##    college                city          state established sponsorship\n##    &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\n##  1 Harvard                Cambridge     MA           1636 Congregational\n##  2 William and Mary       Williamsburg  VA           1693 Anglican\n##  3 Yale                   New Haven     CT           1701 Congregational\n##  4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\n##  5 Princeton              Princeton     NJ           1746 Presbyterian\n##  6 Columbia               New York      NY           1754 Anglican\n##  7 Brown                  Providence    RI           1765 Baptist\n##  8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\n##  9 Dartmouth              Hanover       NH           1769 Congregational\n## 10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\n## # ... with 55 more rows\n</code></pre>\n<p>Let&#39;s also go ahead and see how to write this using the pipe operator\n(%&gt;%):</p>\n<pre><code>early_colleges%&gt;%\n    select(college, city, state, established, sponsorship)\n\n## # A tibble: 65 x 5\n##    college                city          state established sponsorship\n##    &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\n##  1 Harvard                Cambridge     MA           1636 Congregational\n##  2 William and Mary       Williamsburg  VA           1693 Anglican\n##  3 Yale                   New Haven     CT           1701 Congregational\n##  4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\n##  5 Princeton              Princeton     NJ           1746 Presbyterian\n##  6 Columbia               New York      NY           1754 Anglican\n##  7 Brown                  Providence    RI           1765 Baptist\n##  8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\n##  9 Dartmouth              Hanover       NH           1769 Congregational\n## 10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\n## # ... with 55 more rows\n</code></pre>\n<p>Referencing each of the columns that we want to keep just to get rid of\none is a little tedous. We can use the minus symbol (-) to demonstrate\nthat we want to remove a column.</p>\n<pre><code>early_colleges%&gt;%\n    select(-original_name)\n\n## # A tibble: 65 x 5\n##    college                city          state established sponsorship\n##    &lt;chr&gt;                  &lt;chr&gt;         &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;\n##  1 Harvard                Cambridge     MA           1636 Congregational\n##  2 William and Mary       Williamsburg  VA           1693 Anglican\n##  3 Yale                   New Haven     CT           1701 Congregational\n##  4 Pennsylvania, Univ. of Philadelphia  PA           1740 Nondenominational\n##  5 Princeton              Princeton     NJ           1746 Presbyterian\n##  6 Columbia               New York      NY           1754 Anglican\n##  7 Brown                  Providence    RI           1765 Baptist\n##  8 Rutgers                New Brunswick NJ           1766 Dutch Reformed\n##  9 Dartmouth              Hanover       NH           1769 Congregational\n## 10 Charleston, Coll. Of   Charleston    SC           1770 Anglican\n## # ... with 55 more rows\n</code></pre>\n<h3 id=\"filter\">Filter</h3>\n<p>The filter() function does the same thing as the select function but\nrather than choosing the column name, we can use it to filter rows using\na test requirement. For instance, we can view all the colleges that\nexisted before the turn of the century.</p>\n<pre><code>early_colleges%&gt;%\n    filter(established &lt; 1800)\n\n## # A tibble: 20 x 6\n##    college                  original_name         city           state\n##    &lt;chr&gt;                    &lt;chr&gt;                 &lt;chr&gt;          &lt;chr&gt;\n##  1 Harvard                  &lt;NA&gt;                  Cambridge      MA\n##  2 William and Mary         &lt;NA&gt;                  Williamsburg   VA\n##  3 Yale                     &lt;NA&gt;                  New Haven      CT\n##  4 Pennsylvania, Univ. of   &lt;NA&gt;                  Philadelphia   PA\n##  5 Princeton                College of New Jersey Princeton      NJ\n##  6 Columbia                 King&#39;s College        New York       NY\n##  7 Brown                    &lt;NA&gt;                  Providence     RI\n##  8 Rutgers                  Queen&#39;s College       New Brunswick  NJ\n##  9 Dartmouth                &lt;NA&gt;                  Hanover        NH\n## 10 Charleston, Coll. Of     &lt;NA&gt;                  Charleston     SC\n## 11 Hampden-Sydney           &lt;NA&gt;                  Hampden-Sydney VA\n## 12 Transylvania             &lt;NA&gt;                  Lexington      KY\n## 13 Georgia, Univ. of        &lt;NA&gt;                  Athens         GA\n## 14 Georgetown               &lt;NA&gt;                  Washington     DC\n## 15 North Carolina, Univ. of &lt;NA&gt;                  Chapel Hill    NC\n## 16 Vermont, Univ. of        &lt;NA&gt;                  Burlington     VT\n## 17 Williams                 &lt;NA&gt;                  Williamstown   MA\n## 18 Tennessee, Univ. of      Blount College        Knoxville      TN\n## 19 Union College            &lt;NA&gt;                  Schenectady    NY\n## 20 Marietta                 &lt;NA&gt;                  Marietta       OH\n##    established sponsorship\n##          &lt;int&gt; &lt;chr&gt;\n##  1        1636 Congregational\n##  2        1693 Anglican\n##  3        1701 Congregational\n##  4        1740 Nondenominational\n##  5        1746 Presbyterian\n##  6        1754 Anglican\n##  7        1765 Baptist\n##  8        1766 Dutch Reformed\n##  9        1769 Congregational\n## 10        1770 Anglican\n## 11        1775 Presbyterian\n## 12        1780 Disciples of Christ\n## 13        1785 Secular\n## 14        1789 Roman Catholic\n## 15        1789 Secular\n## 16        1791 Nondenominational\n## 17        1793 Congregational\n## 18        1794 Secular\n## 19        1795 Presbyterian with Congregational\n## 20        1797 Congregational\n</code></pre>\n<h3 id=\"mutate\">Mutate</h3>\n<p>The mutate command allows you to add a column to your data frame. Right\nnow, we have the city and state in two separate columns. We can use the\npaste command to combine two strings and specify a seperator. Let&#39;s place\nthem in a single column called &quot;location.&quot;</p>\n<pre><code>early_colleges%&gt;%mutate(location=paste(city,state,sep=&quot;,&quot;))\n\n## # A tibble: 65 x 7\n##    college                original_name         city          state\n##    &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;\n##  1 Harvard                &lt;NA&gt;                  Cambridge     MA\n##  2 William and Mary       &lt;NA&gt;                  Williamsburg  VA\n##  3 Yale                   &lt;NA&gt;                  New Haven     CT\n##  4 Pennsylvania, Univ. of &lt;NA&gt;                  Philadelphia  PA\n##  5 Princeton              College of New Jersey Princeton     NJ\n##  6 Columbia               King&#39;s College        New York      NY\n##  7 Brown                  &lt;NA&gt;                  Providence    RI\n##  8 Rutgers                Queen&#39;s College       New Brunswick NJ\n##  9 Dartmouth              &lt;NA&gt;                  Hanover       NH\n## 10 Charleston, Coll. Of   &lt;NA&gt;                  Charleston    SC\n##    established sponsorship       location\n##          &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;\n##  1        1636 Congregational    Cambridge,MA\n##  2        1693 Anglican          Williamsburg,VA\n##  3        1701 Congregational    New Haven,CT\n##  4        1740 Nondenominational Philadelphia,PA\n##  5        1746 Presbyterian      Princeton,NJ\n##  6        1754 Anglican          New York,NY\n##  7        1765 Baptist           Providence,RI\n##  8        1766 Dutch Reformed    New Brunswick,NJ\n##  9        1769 Congregational    Hanover,NH\n## 10        1770 Anglican          Charleston,SC\n## # ... with 55 more rows\n</code></pre>\n<p>Again, you need to remember that dplyr does not save the data or\nmanipulate the original. Instead, it creates a temporary data frame at\neach step. If you want to keep it, you need to create a permanent\nvariable.</p>\n<pre><code>early_colleges_with_location &lt;- early_colleges%&gt;%\n    mutate(location=paste(city, state, sep=&quot;,&quot;))\n\n# View the new tibble with the location added\nearly_colleges_with_location\n\n## # A tibble: 65 x 7\n##    college                original_name         city          state\n##    &lt;chr&gt;                  &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;\n##  1 Harvard                &lt;NA&gt;                  Cambridge     MA\n##  2 William and Mary       &lt;NA&gt;                  Williamsburg  VA\n##  3 Yale                   &lt;NA&gt;                  New Haven     CT\n##  4 Pennsylvania, Univ. of &lt;NA&gt;                  Philadelphia  PA\n##  5 Princeton              College of New Jersey Princeton     NJ\n##  6 Columbia               King&#39;s College        New York      NY\n##  7 Brown                  &lt;NA&gt;                  Providence    RI\n##  8 Rutgers                Queen&#39;s College       New Brunswick NJ\n##  9 Dartmouth              &lt;NA&gt;                  Hanover       NH\n## 10 Charleston, Coll. Of   &lt;NA&gt;                  Charleston    SC\n##    established sponsorship       location\n##          &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;\n##  1        1636 Congregational    Cambridge,MA\n##  2        1693 Anglican          Williamsburg,VA\n##  3        1701 Congregational    New Haven,CT\n##  4        1740 Nondenominational Philadelphia,PA\n##  5        1746 Presbyterian      Princeton,NJ\n##  6        1754 Anglican          New York,NY\n##  7        1765 Baptist           Providence,RI\n##  8        1766 Dutch Reformed    New Brunswick,NJ\n##  9        1769 Congregational    Hanover,NH\n## 10        1770 Anglican          Charleston,SC\n## # ... with 55 more rows\n</code></pre>\n<h3 id=\"arrange\">Arrange</h3>\n<p>The arrange() function allows us to order our columns in a new way.\nCurrently, the colleges are organized by year in ascending order. Lets\nplace them in descending order of establishment, in this case, from the end of the Mexican-American War.</p>\n<pre><code>early_colleges %&gt;%\n    arrange(desc(established))\n\n## # A tibble: 65 x 6\n##    college               original_name city        state established\n##    &lt;chr&gt;                 &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;       &lt;int&gt;\n##  1 Wisconsin, Univ. of   &lt;NA&gt;          Madison     WI           1848\n##  2 Earlham               &lt;NA&gt;          Richmond    IN           1847\n##  3 Beloit                &lt;NA&gt;          Beloit      WI           1846\n##  4 Bucknell              &lt;NA&gt;          Lewisburg   PA           1846\n##  5 Grinnell              &lt;NA&gt;          Grinnell    IA           1846\n##  6 Mount Union           &lt;NA&gt;          Alliance    OH           1846\n##  7 Louisiana, Univ. of   &lt;NA&gt;          New Orleans LA           1845\n##  8 U.S. Naval Academy    &lt;NA&gt;          Annapolis   MD           1845\n##  9 Mississipps, Univ. of &lt;NA&gt;          Oxford      MI           1844\n## 10 Holy Cross            &lt;NA&gt;          Worchester  MA           1843\n##    sponsorship\n##    &lt;chr&gt;\n##  1 Secular\n##  2 Quaker\n##  3 Congregational\n##  4 Baptist\n##  5 Congregational\n##  6 Methodist\n##  7 Secular\n##  8 Secular\n##  9 Secular\n## 10 Roman Catholic\n## # ... with 55 more rows\n</code></pre>\n<h3 id=\"summarise\">Summarise</h3>\n<p>The last key function in dplyr is summarise()--note the British\nspelling. Summarise() takes a function or operation, and is usually used\nto create a data frame that contains summary statistics for plotting. We\nwill use it to calculate the average year that colleges before 1848 were\nfounded.</p>\n<pre><code>early_colleges%&gt;%summarise(mean(established))\n\n## # A tibble: 1 x 1\n##   `mean(established)`\n##                 &lt;dbl&gt;\n## 1            1809.831\n</code></pre>\n<h1 id=\"putting-it-all-together\">Putting it All Together</h1>\n<p>Now that we have gone through the five main verbs for dplyr, we can use\nthem to create a quick visualization of our data. Let&#39;s go ahead and\ncreate a bar graph showing the number of secular and non-secular\ncolleges founded before the U.S. War of 1812:</p>\n<pre><code>secular_colleges_before_1812&lt;-early_colleges%&gt;%\n  filter(established &lt; 1812)%&gt;%\n  mutate(is_secular=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;yes&quot;))\n\nggplot(secular_colleges_before_1812) +\n  geom_bar(aes(x=is_secular, fill=is_secular))+\n  labs(x=&quot;Is the college secular?&quot;)\n</code></pre>\n<p>{% include figure.html filename=&quot;college_secular_before_1812.png&quot; caption=&quot;Number of secular and non-secular colleges before War of 1812&quot; %}</p>\n<p>Again, by making a quick change to our code, we can also look at the\nnumber of secular versus non-secular colleges founded after the start of\nthe War of 1812:</p>\n<pre><code>secular_colleges_after_1812&lt;-early_colleges%&gt;%\n  filter(established &gt; 1812)%&gt;%\n  mutate(is_secular=ifelse(sponsorship!=&quot;Secular&quot;, &quot;no&quot;, &quot;yes&quot;))\n\nggplot(secular_colleges_after_1812) +\n  geom_bar(aes(x=is_secular, fill=is_secular))+\n  labs(x=&quot;Is the college secular?&quot;)\n</code></pre>\n<p>({% include figure.html filename=&quot;college_secular_after_1812.png&quot; caption=&quot;Number of secular and non-secular colleges after War of 1812&quot; %}</p>\n<h1 id=\"conclusion\">Conclusion</h1>\n<p>This tutorial should put you well on the way to thinking about how to\norganize and manipulate your data in R. Later, you will probably want to\ngraph your data in some way. I recommend that you begin looking at the\n<a href=\"https://ggplot2.tidyverse.org/\">ggplot2</a> package for a set of tools that work\nwell with dplyr. In addition, you may want to examine some of the\nother functions that come with dplyr to hone your skills. Either way,\nthis should provide a good foundation to build on and cover a lot of\nthe common problems you will encounter.</p>\n"}